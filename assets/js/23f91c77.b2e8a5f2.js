"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[52376],{83870:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>x,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var i=s(74848),n=s(28453);const r={id:"microservices-configs",title:"Microservices configs",slug:"/setup/swarm/advanced/microservices-configs/",sidebar_position:7.5},l=void 0,c={id:"setup/swarm/advanced/microservices-configs",title:"Microservices configs",description:"This page covers possibilities offered by our inventory that you can configure inside the inventory",source:"@site/docs/setup/swarm/advanced/swarm-other-configs.md",sourceDirName:"setup/swarm/advanced",slug:"/setup/swarm/advanced/microservices-configs/",permalink:"/docs/setup/swarm/advanced/microservices-configs/",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/docs/setup/swarm/advanced/swarm-other-configs.md",tags:[],version:"current",sidebarPosition:7.5,frontMatter:{id:"microservices-configs",title:"Microservices configs",slug:"/setup/swarm/advanced/microservices-configs/",sidebar_position:7.5},sidebar:"install",previous:{title:"Microservices optimizations",permalink:"/docs/setup/swarm/advanced/optimizations/"},next:{title:"Ansible Vault",permalink:"/docs/setup/swarm/advanced/ansible-vault"}},d={},o=[{value:"Security",id:"security",level:3},{value:"Mail",id:"mail",level:3},{value:"Account password configuration",id:"account-password-configuration",level:3},{value:"Account and password validity",id:"account-and-password-validity",level:3},{value:"Token validity",id:"token-validity",level:3},{value:"REGARDS Microservice Certificate Authorities",id:"regards-microservice-certificate-authorities",level:3},{value:"REGARDS Proxy",id:"regards-proxy",level:3},{value:"REGARDS session",id:"regards-session",level:3}];function a(e){const t={code:"code",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["This page covers possibilities offered by our inventory that you can configure inside the inventory\nfile ",(0,i.jsx)(t.code,{children:"inventories/<your inventory>/group_vars/regards_nodes/main.yml"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"security",children:"Security"}),"\n",(0,i.jsx)(t.p,{children:"You can configure JWT access token like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:'group_config_mservices:\n  # Token secret (REGARDS API and Orders direct download links) - (64 characters max)\n  jwt_secret: "{{ regards_vault.group_config_mservices.authentication.jwt_secret }}"\n  jwt_key_hs256: "{{ regards_vault.group_config_mservices.authentication.jwt_key_hs256 }}"\n  jwt_key_hs384: "{{ regards_vault.group_config_mservices.authentication.jwt_key_hs384 }}"\n  jwt_key_hs512: "{{ regards_vault.group_config_mservices.authentication.jwt_key_hs512 }}"\n  order_jwt_secret: "{{ regards_vault.group_config_mservices.authentication.order_jwt_secret }}"\n  # Password to crypt DB secret (16 characters max)\n  cipher_iv: "{{ regards_vault.group_config_mservices.authentication.cipher_iv }}"\n'})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Constraints"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.jwt_secret"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"JWT secret"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Recommended for production."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.jwt_key_hs256"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"JWT secret HS256"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Recommended for production."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.jwt_key_hs384"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"JWT secret HS384"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Recommended for production."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.jwt_key_hs512"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"JWT secret HS512"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Recommended for production."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.order_jwt_secret"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"JWT secret"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Recommended for production. Used to authenticate order links."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.cipher_iv"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Cipher IV"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. 16 characters max. Recommended for production."})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"mail",children:"Mail"}),"\n",(0,i.jsx)(t.p,{children:"Mail configuration used by microservices can be configured like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  mail:\n    host: smtprelay.regards.fr\n    port: 25\n    username: admin@regards.fr\n    password: my vaulted password\n    noreply: no-reply@regards.fr\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Constraints"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.mail.host"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"SMTP Host"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Facultative. Default: ",(0,i.jsx)(t.code,{children:"rs-maildev"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.mail.port"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"SMTP port"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Facultative. Default: ",(0,i.jsx)(t.code,{children:"1025"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.mail.username"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"SMTP username"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Empty by default"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.mail.password"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"SMTP password"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Empty by default"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.mail.noreply"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No reply adress"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Facultative. Default: ",(0,i.jsx)(t.code,{children:"regards@noreply.fr"})]})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"account-password-configuration",children:"Account password configuration"}),"\n",(0,i.jsx)(t.p,{children:"Mail configuration used by microservices can be configured like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  password_config:\n    regex: ^.+$\n    info: Password must contains at least 1 character\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.password_config.regex"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Regex"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Regex used by the backend service to validate new password"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.password_config.info"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Password information displayed to users"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"account-and-password-validity",children:"Account and password validity"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  account_validity_in_days: 10\n  account_password_validity_in_days: 10\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.account_validity_in_days"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Number of days before an account will be deactivated. If you provide 0, this check is disabled"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.account_password_validity_in_days"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Number of days before an account password must be generated. If you provide 0, this check is disabled"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"token-validity",children:"Token validity"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  access_token_validity: 2592000\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.access_token_validity"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Number of seconds a token last"})]})})]}),"\n",(0,i.jsx)(t.h3,{id:"regards-microservice-certificate-authorities",children:"REGARDS Microservice Certificate Authorities"}),"\n",(0,i.jsx)(t.p,{children:"You can load additional certificate authorities into REGARDS JVM like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  ca_certificates:\n    - AC_SOME_AUTHORITY.crt\n    - AC_ANOTHER_AUTHORITY.crt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Related files must be located inside ",(0,i.jsx)(t.code,{children:"<your inventory>/static/ca-certificates"}),", like this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"$ cd 'inventories/<your inventory>/static/ca-certificates'\n$ ls\nAC_SOME_AUTHORITY.crt\nAC_ANOTHER_AUTHORITY.crt\n"})}),"\n",(0,i.jsx)(t.h3,{id:"regards-proxy",children:"REGARDS Proxy"}),"\n",(0,i.jsx)(t.p,{children:"If REGARDS microservices need a proxy to access to another system, you can configure it:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  proxy:\n    url: http://myproxy.regards.fr\n    username: regards\n    password: password\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Constraints"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.proxy.url"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Proxy URL"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative, false, or a valid URL"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.proxy.username"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Proxy username"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Empty by default"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.proxy.password"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Proxy password"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Empty by default"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"regards-session",children:"REGARDS session"}),"\n",(0,i.jsx)(t.p,{children:"You can configure REGARDS session retention duration like this :"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"group_config_mservices:\n  session:\n    retention_days: 30\n    dashboard_retention_days: 90\n"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.session.retention_days"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Number of retention days of inactive sessions (agent side) in days. Default to 5 days"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"group_docker_mservices.session.dashboard_retention_days"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"Int"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Number of retention days of inactive sessions (manager side) in days. Default to 30 days"})]})]})]})]})}function x(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>c});var i=s(96540);const n={},r=i.createContext(n);function l(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);