"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[93567],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return k}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),o=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=o(e.components);return n.createElement(d.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,d=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),u=o(a),k=r,N=u["".concat(d,".").concat(k)]||u[k]||s[k]||l;return a?n.createElement(N,i(i({ref:t},m),{},{components:a})):n.createElement(N,i({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=u;var p={};for(var d in t)hasOwnProperty.call(t,d)&&(p[d]=t[d]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var o=2;o<l;o++)i[o]=a[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},60601:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return p},contentTitle:function(){return d},metadata:function(){return o},toc:function(){return m},default:function(){return u}});var n=a(87462),r=a(63366),l=(a(67294),a(3905)),i=["components"],p={id:"backend-fem-amqp-api",title:"Feature Manager AMQP API",sidebar_label:"Feature Manager AMQP",slug:"/development/backend/fem/api/amqp/"},d=void 0,o={unversionedId:"development/backend/regards/fem/api/backend-fem-amqp-api",id:"version-1.4.0/development/backend/regards/fem/api/backend-fem-amqp-api",title:"Feature Manager AMQP API",description:"{@import feature-management-intro.md}",source:"@site/versioned_docs/version-1.4.0/development/backend/regards/fem/api/feature-management-amqp-api.md",sourceDirName:"development/backend/regards/fem/api",slug:"/development/backend/fem/api/amqp/",permalink:"/docs/1.4.0/development/backend/fem/api/amqp/",editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-1.4.0/development/backend/regards/fem/api/feature-management-amqp-api.md",tags:[],version:"1.4.0",frontMatter:{id:"backend-fem-amqp-api",title:"Feature Manager AMQP API",sidebar_label:"Feature Manager AMQP",slug:"/development/backend/fem/api/amqp/"},sidebar:"version-1.4.0/dev",previous:{title:"Feature Manager REST",permalink:"/docs/1.4.0/development/backend/fem/api/rest/"},next:{title:"Feature Factory",permalink:"/docs/1.4.0/development/backend/fem/plugins/feature-factory/"}},m=[{value:"AMQP API",id:"amqp-api",children:[{value:"Feature creation request",id:"feature-creation-request",children:[{value:"Example",id:"example",children:[],level:4}],level:3},{value:"Feature creation request by file reference",id:"feature-creation-request-by-file-reference",children:[{value:"V1.3.0 to V1.4.0 migration",id:"v130-to-v140-migration",children:[],level:4},{value:"Example",id:"example-1",children:[],level:4}],level:3},{value:"Feature patch request",id:"feature-patch-request",children:[{value:"Example",id:"example-2",children:[],level:4}],level:3},{value:"Feature deletion request",id:"feature-deletion-request",children:[{value:"Example",id:"example-3",children:[],level:4}],level:3}],level:2},{value:"AMQP monitoring API...",id:"amqp-monitoring-api",children:[{value:"Example of DENIED request",id:"example-of-denied-request",children:[],level:4},{value:"Example of GRANTED request",id:"example-of-granted-request",children:[],level:4},{value:"Example of SUCCESS request",id:"example-of-success-request",children:[],level:4},{value:"Example of ERROR request",id:"example-of-error-request",children:[],level:4},{value:"...For feature module",id:"for-feature-module",children:[],level:3},{value:"...For featureprovider module",id:"for-featureprovider-module",children:[],level:3}],level:2}],s={toc:m};function u(e){var t=e.components,a=(0,r.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("h2",{parentName:"p"},"Overview"),(0,l.kt)("p",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"p"},"Feature management")," microservice is a data repository in ",(0,l.kt)("a",{parentName:"p",href:"https://geojson.org/"},"GeoJSON format"),"."),(0,l.kt)("p",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"p"},"Feature Management")," reponsabilities:"),(0,l.kt)("ul",{parentName:"p"},(0,l.kt)("li",{parentName:"ul"},"Extract data references thanks to ","[IFeatureFactoryPlugins]",","),(0,l.kt)("li",{parentName:"ul"},"Create, patch or delete data references,"),(0,l.kt)("li",{parentName:"ul"},"Re-notify stakeholders of existing data references,"),(0,l.kt)("li",{parentName:"ul"},"Delegate the storage of files (if any) to ",(0,l.kt)("inlineCode",{parentName:"li"},"Storage Management"),".")),(0,l.kt)("p",{parentName:"p"},"To edit this repository, a data producer has to send ",(0,l.kt)("strong",{parentName:"p"},"requests"),"."),(0,l.kt)("p",{parentName:"p"},"At the moment, 2 API are available :"),(0,l.kt)("ul",{parentName:"p"},(0,l.kt)("li",{parentName:"ul"},"Messaging API (",(0,l.kt)("a",{parentName:"li",href:"https://www.amqp.org/"},"AMQP"),") allows to publish creation, reference, patch, deletion and notification requests on specific exchanges."),(0,l.kt)("li",{parentName:"ul"},"HTTP REST API allows to submit creation requests (as ",(0,l.kt)("inlineCode",{parentName:"li"},"POST")," HTTP requests), update requests (as ",(0,l.kt)("inlineCode",{parentName:"li"},"PATCH")," HTTP requests) or deletion requests (as ",(0,l.kt)("inlineCode",{parentName:"li"},"DELETE")," HTTP requests).")),(0,l.kt)("p",{parentName:"p"},(0,l.kt)("img",{parentName:"p",src:"/schemas/feature_management/architectural_concepts_fem.png",alt:"Feature management architectural concepts"})),(0,l.kt)("p",{parentName:"p"},"Under the hood, those reponsabilities are divided between two modules: ",(0,l.kt)("inlineCode",{parentName:"p"},"featureprovider")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"feature"),". ",(0,l.kt)("inlineCode",{parentName:"p"},"featureprovider")," is only responsible for handling data references extraction requests, that is extraction of information needed from physical files to create a data reference that is then handled by the ",(0,l.kt)("inlineCode",{parentName:"p"},"feature")," module."),(0,l.kt)("p",{parentName:"p"},"API are documented in detail below."),(0,l.kt)("h2",{parentName:"p"},"Request payload"),(0,l.kt)("p",{parentName:"p"},"Regardless of the API used, payload of each API is expected in ",(0,l.kt)("a",{parentName:"p",href:"https://geojson.org/"},"GeoJSON format"),"."),(0,l.kt)("p",{parentName:"p"},"The basic structure is as follows :"),(0,l.kt)("ul",{parentName:"p"},(0,l.kt)("li",{parentName:"ul"},"A required ",(0,l.kt)("inlineCode",{parentName:"li"},"id"),","),(0,l.kt)("li",{parentName:"ul"},"A required ",(0,l.kt)("inlineCode",{parentName:"li"},"type")," with value ",(0,l.kt)("inlineCode",{parentName:"li"},"Feature"),","),(0,l.kt)("li",{parentName:"ul"},"An optional ",(0,l.kt)("a",{parentName:"li",href:"https://tools.ietf.org/html/rfc7946#section-3.1"},"geometry in GeoJSON format"),","),(0,l.kt)("li",{parentName:"ul"},"An optional set of ",(0,l.kt)("inlineCode",{parentName:"li"},"properties"),".")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "FeatureId",\n    "type": "Feature",\n    "geometry": {\n        "type": "Point",\n        "coordinates": [\n            125.6,\n            10.1\n        ]\n    },\n    "properties": {\n        "name": "Dinagat Islands"\n    }\n}\n')),(0,l.kt)("p",{parentName:"p"},"For the purposes of this microservice, GeoJSON structure is extended  with following properties :"),(0,l.kt)("ul",{parentName:"p"},(0,l.kt)("li",{parentName:"ul"},"An ",(0,l.kt)("inlineCode",{parentName:"li"},"urn")," (uniform resource name as unique identifier) generated by the microservice when creating a new reference and ",(0,l.kt)("strong",{parentName:"li"},"expected only")," when updating a reference."),(0,l.kt)("li",{parentName:"ul"},"A required ",(0,l.kt)("inlineCode",{parentName:"li"},"model")," representing the name of the model defining the expected ",(0,l.kt)("inlineCode",{parentName:"li"},"properties")," field structure (and previously configured)."),(0,l.kt)("li",{parentName:"ul"},"A required ",(0,l.kt)("inlineCode",{parentName:"li"},"entityType")," defining the reference business type."),(0,l.kt)("li",{parentName:"ul"},"An optional ",(0,l.kt)("inlineCode",{parentName:"li"},"files")," property with a fixed structure that allows to store or reference physical data (service delegated to another microservice called ",(0,l.kt)("inlineCode",{parentName:"li"},"Storage Management"),").")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "FeatureId",\n    "urn": "UniqueFeatureId",\n    "model": "RelatedModelName",\n    "entityType": "DATA",\n    "type": "Feature",\n    "geometry": {\n        "type": "Point",\n        "coordinates": [\n            125.6,\n            10.1\n        ]\n    },\n    "properties": {\n        "name": "Dinagat Islands"\n    },\n    "files": [\n        {\n            "locations": [\n                {\n                    "storage": "DISK",\n                    "url": "file://home/user/regards/file.zip"\n                }\n            ],\n            "attributes": {\n                "dataType": "RAWDATA",\n                "mimeType": "application/zip",\n                "filename": "file.zip",\n                "filesize": "8013",\n                "algorithm": "MD5",\n                "checksum": "4e188bd8a6288164c25c3728ce394927"\n            }\n        }\n    ]\n}\n')),(0,l.kt)("a",{name:"payloadppt"}),(0,l.kt)("h3",{parentName:"p"},"Payload detailed properties"),(0,l.kt)("h4",{parentName:"p"},"Feature"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"center"},"Path"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Description"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Optional"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"id"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Id from provider"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"urn"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Unique feature identifer based on provider identifier with TEST:REQUEST:2342"),(0,l.kt)("td",{parentName:"tr",align:"center"})))),(0,l.kt)("div",{parentName:"p",className:"admonition admonition-danger alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Urn is only expected in update and deletion requests!"))),(0,l.kt)("h4",{parentName:"p"},"Files"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"center"},"Path"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Description"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Optional"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"locations[].storage"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Storage"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"locations[].url"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Url location"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.dataType"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"RAWDATA, QUICKLOOK_SD, QUICKLOOK_MD, QUICKLOOK_HD, DOCUMENT, THUMBNAIL, DESCRIPTION"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.mimeType"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"MIME type"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.filename"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Filename"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.filesize"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"Number")),(0,l.kt)("td",{parentName:"tr",align:"center"},"File size"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.algorithm"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Checksum algorithm"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"attributes.checksum"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Checksum"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")))),(0,l.kt)("div",{parentName:"p",className:"admonition admonition-danger alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Algorithm & cheksum are required if data have to be stored by ",(0,l.kt)("inlineCode",{parentName:"p"},"Storage Management"),"."))),(0,l.kt)("a",{name:"metadatappt"}),(0,l.kt)("h2",{parentName:"p"},"Request metadata"),(0,l.kt)("p",{parentName:"p"},"As the payload, regardless of the API used, metadata is often associated with a request. "),(0,l.kt)("h3",{parentName:"p"},"Metadata detailed properties"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"center"},"Path"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Type"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Description"),(0,l.kt)("th",{parentName:"tr",align:"center"},"Optional"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.session"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Arbitrary session name to classify data for human operators"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.sessionOwner"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Arbitrary session owner to classify data for human operators"),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.storages"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"Array")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Target storages if there are files to store (may be empty!)"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.storages[].pluginBusinessId"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Storage plugin identifier (previously configured in ",(0,l.kt)("inlineCode",{parentName:"td"},"Storage Management")),(0,l.kt)("td",{parentName:"tr",align:"center"})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.storages[].targetTypes"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"Array")),(0,l.kt)("td",{parentName:"tr",align:"center"},"List of data object types accepted by this storage location"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.storages[].storePath"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"Directory in which to store the file"),(0,l.kt)("td",{parentName:"tr",align:"center"},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"center"},"metadata.priority"),(0,l.kt)("td",{parentName:"tr",align:"center"},(0,l.kt)("inlineCode",{parentName:"td"},"String")),(0,l.kt)("td",{parentName:"tr",align:"center"},"HIGH, NORMAL, LOW"),(0,l.kt)("td",{parentName:"tr",align:"center"}))))),(0,l.kt)("h2",{id:"amqp-api"},"AMQP API"),(0,l.kt)("h3",{id:"feature-creation-request"},"Feature creation request"),(0,l.kt)("p",null,"Request has to be published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.in.FeatureCreationRequestEvent")),(0,l.kt)("p",null,"With following properties:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metadata"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#metadatappt"},"description above"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"feature"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#payloadppt"},"description above"),")")))),(0,l.kt)("p",null,"And following headers:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.tenant"),(0,l.kt)("td",{parentName:"tr",align:null},"The tenant")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")))),(0,l.kt)("p",null,(0,l.kt)("h4",{parentName:"p"},"V1.1.0 to V1.2.0 migration"),(0,l.kt)("p",{parentName:"p"},"Removed properties (replaced by headers):"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestId"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestOwner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestDate"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")))),(0,l.kt)("p",{parentName:"p"},"Removed headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.converter"),(0,l.kt)("td",{parentName:"tr",align:null},"GSON")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.type"),(0,l.kt)("td",{parentName:"tr",align:null},"fr.cnes.regards.modules.feature.dto.event.in.*")))),(0,l.kt)("p",{parentName:"p"},"New headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long"))))),(0,l.kt)("h4",{id:"example"},"Example"),(0,l.kt)("p",null,(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Headers\nregards.tenant=project1\nregards.request.id=12345463-0f6b-4488-b58c-52af3f7e9563\nregards.request.owner=owner\nregards.request.date=2019-07-04T01:03:00\n")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "metadata": {\n        "sessionOwner": "owner",\n        "session": "session",\n        "storages": [\n            {\n                "pluginBusinessId": "disk"\n            }\n        ],\n        "priority": "NORMAL"\n    },\n    "feature": {\n        "entityType": "DATA",\n        "model": "FEATURE01",\n        "files": [\n            {\n                "locations": [\n                    {\n                        "storage": null,\n                        "url": "http://www.test.com/filename.xml"\n                    }\n                ],\n                "attributes": {\n                    "dataType": "RAWDATA",\n                    "mimeType": "application/xml",\n                    "filename": "filename",\n                    "filesize": 100,\n                    "algorithm": "MD5",\n                    "checksum": "checksum"\n                }\n            }\n        ],\n        "id": "MyId",\n        "geometry": {\n            "coordinates": [\n                10.0,\n                20.0\n            ],\n            "type": "Point",\n            "bbox": null,\n            "crs": null\n        },\n        "normalizedGeometry": null,\n        "properties": {\n            "data_type": "TYPE01",\n            "file_characterization": {\n                "valid": true\n            }\n        },\n        "type": "Feature"\n    }\n}\n'))),(0,l.kt)("h3",{id:"feature-creation-request-by-file-reference"},"Feature creation request by file reference"),(0,l.kt)("p",null,"This API allows to generate feature by extracting metadata from the passed location."),(0,l.kt)("p",null,"Request has to be published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.featureprovider.domain.FeatureExtractionRequestEvent")),(0,l.kt)("p",null,"With following properties:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metadata"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#metadatappt"},"description above"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"parameters"),(0,l.kt)("td",{parentName:"tr",align:null},"Free JSON parameters to be used by related factory")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"factory"),(0,l.kt)("td",{parentName:"tr",align:null},"Plugin business identifier representing the feature factory to use")))),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Factory must have been configured beforehand."))),(0,l.kt)("p",null,"And following headers:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.tenant"),(0,l.kt)("td",{parentName:"tr",align:null},"The tenant")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")))),(0,l.kt)("p",null,(0,l.kt)("h4",{parentName:"p"},"V1.1.0 to V1.2.0 migration"),(0,l.kt)("p",{parentName:"p"},"Removed properties (replaced by headers):"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestId"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestOwner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestDate"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")))),(0,l.kt)("p",{parentName:"p"},"Removed headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.converter"),(0,l.kt)("td",{parentName:"tr",align:null},"GSON")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.type"),(0,l.kt)("td",{parentName:"tr",align:null},"fr.cnes.regards.modules.feature.dto.event.in.*")))),(0,l.kt)("p",{parentName:"p"},"New headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long"))))),(0,l.kt)("h4",{id:"v130-to-v140-migration"},"V1.3.0 to V1.4.0 migration"),(0,l.kt)("p",null,"New extraction requests has to be published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.featureprovider.domain.FeatureExtractionRequestEvent"),"\nIn previous version reference requests were sent to : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.in.FeatureReferenceRequestEvent")),(0,l.kt)("h4",{id:"example-1"},"Example"),(0,l.kt)("p",null,(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Headers\nregards.tenant=project1\nregards.request.id=12345463-0f6b-4488-b58c-52af3f7e9563\nregards.request.owner=owner\nregards.request.date=2019-07-04T01:03:00\n")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "metadata": {\n        "sessionOwner": "owner",\n        "session": "session",\n        "storages": [\n            {\n                "pluginBusinessId": "disk"\n            }\n        ],\n        "priority": "NORMAL"\n    },\n    "factory": "{factory identifier}",\n    "parameters": {\n        "location":"my/file/location"\n    }\n}\n'))),(0,l.kt)("h3",{id:"feature-patch-request"},"Feature patch request"),(0,l.kt)("p",null,"Request has to be published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.in.FeatureUpdateRequestEvent")),(0,l.kt)("p",null,"With following properties:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metadata.priority"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#metadatappt"},"description above"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metadata.storages"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#metadatappt"},"description above"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"feature"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#payloadppt"},"description above"),")")))),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Only properties to be updated can be passed on ... they will be merged with existing ones."))),(0,l.kt)("p",null,"And following headers:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.tenant"),(0,l.kt)("td",{parentName:"tr",align:null},"The tenant")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")))),(0,l.kt)("p",null,(0,l.kt)("h4",{parentName:"p"},"V1.1.0 to V1.2.0 migration"),(0,l.kt)("p",{parentName:"p"},"Removed properties (replaced by headers):"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestId"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestOwner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestDate"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")))),(0,l.kt)("p",{parentName:"p"},"Removed headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.converter"),(0,l.kt)("td",{parentName:"tr",align:null},"GSON")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.type"),(0,l.kt)("td",{parentName:"tr",align:null},"fr.cnes.regards.modules.feature.dto.event.in.*")))),(0,l.kt)("p",{parentName:"p"},"New headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long"))))),(0,l.kt)("h4",{id:"example-2"},"Example"),(0,l.kt)("p",null,(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Headers\nregards.tenant=project1\nregards.request.id=12345463-0f6b-4488-b58c-52af3f7e9563\nregards.request.owner=owner\nregards.request.date=2019-07-04T01:03:00\n")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "metadata": {\n        "storages": [],\n        "priority": "NORMAL"\n    },\n    "feature": {\n        "urn": "URN:FEATURE:DATA:tenant:87fdda0e-27d1-494f-a1c0-c57f2f0810f7:V1",\n        "entityType": "DATA",\n        "model": "FEATURE01",\n        "files": [],\n        "id": "MyId",\n        "geometry": null,\n        "normalizedGeometry": null,\n        "properties": {\n            "file_characterization": {\n                "invalidation_date": "2019-12-03T12:31:42.466Z",\n                "valid": false\n            }\n        },\n        "type": "Feature"\n    }\n}\n'))),(0,l.kt)("h3",{id:"feature-deletion-request"},"Feature deletion request"),(0,l.kt)("p",null,"Request has to be published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.in.FeatureDeletionRequestEvent")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"priority"),(0,l.kt)("td",{parentName:"tr",align:null},"(look at ",(0,l.kt)("a",{parentName:"td",href:"#metadatappt"},"description above"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"urn"),(0,l.kt)("td",{parentName:"tr",align:null},"Unique identifier of the feature")))),(0,l.kt)("p",null,"With following headers:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.tenant"),(0,l.kt)("td",{parentName:"tr",align:null},"The tenant")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")))),(0,l.kt)("p",null,(0,l.kt)("h4",{parentName:"p"},"V1.1.0 to V1.2.0 migration"),(0,l.kt)("p",{parentName:"p"},"Removed properties (replaced by headers):"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestId"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestOwner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"requestDate"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")))),(0,l.kt)("p",{parentName:"p"},"Removed headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.converter"),(0,l.kt)("td",{parentName:"tr",align:null},"GSON")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.type"),(0,l.kt)("td",{parentName:"tr",align:null},"fr.cnes.regards.modules.feature.dto.event.in.*")))),(0,l.kt)("p",{parentName:"p"},"New headers:"),(0,l.kt)("table",{parentName:"p"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Header"),(0,l.kt)("th",{parentName:"tr",align:null},"Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.id"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 36 characters long")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.date"),(0,l.kt)("td",{parentName:"tr",align:null},"ISO 8601 date")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"regards.request.owner"),(0,l.kt)("td",{parentName:"tr",align:null},"String of max 128 characters long"))))),(0,l.kt)("h4",{id:"example-3"},"Example"),(0,l.kt)("p",null,(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Headers\nregards.tenant=project1\nregards.request.id=78938463-023a-4488-b58c-52af3f7e9446\nregards.request.owner=owner\nregards.request.date=2020-03-17T12:24:05.995Z\n")),(0,l.kt)("pre",{parentName:"p"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "priority": "NORMAL",\n    "urn": "URN:FEATURE:DATA:tenant:87fdda0e-27d1-494f-a1c0-c57f2f0810f7:V1"\n}\n'))),(0,l.kt)("h2",{id:"amqp-monitoring-api"},"AMQP monitoring API..."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Feature manager")," microservice publishes AMQP messages to monitor request lifecycle."),(0,l.kt)("p",null,"Messages are published to two different exchanges because under the hood ",(0,l.kt)("inlineCode",{parentName:"p"},"Feature manager")," is in reality composed of two modules: ",(0,l.kt)("inlineCode",{parentName:"p"},"feature")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"featureprovider"),". Whatever the exchange to which those monitoring messages are comming from, they have the same structure, that is:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The ",(0,l.kt)("inlineCode",{parentName:"li"},"requestId")," (corresponds to ",(0,l.kt)("inlineCode",{parentName:"li"},"regards.request.id")," header),"),(0,l.kt)("li",{parentName:"ul"},"The ",(0,l.kt)("inlineCode",{parentName:"li"},"requestOwner")," (corresponds to ",(0,l.kt)("inlineCode",{parentName:"li"},"regards.request.owner")," header),"),(0,l.kt)("li",{parentName:"ul"},"The related feature ",(0,l.kt)("inlineCode",{parentName:"li"},"id"),","),(0,l.kt)("li",{parentName:"ul"},"The related feature ",(0,l.kt)("inlineCode",{parentName:"li"},"urn"),","),(0,l.kt)("li",{parentName:"ul"},"The request type (",(0,l.kt)("inlineCode",{parentName:"li"},"EXTRACTION"),",",(0,l.kt)("inlineCode",{parentName:"li"},"CREATION"),",",(0,l.kt)("inlineCode",{parentName:"li"},"PATCH"),",",(0,l.kt)("inlineCode",{parentName:"li"},"DELETION"),",",(0,l.kt)("inlineCode",{parentName:"li"},"NOTIFICATION"),",",(0,l.kt)("inlineCode",{parentName:"li"},"FILE_COPY"),",",(0,l.kt)("inlineCode",{parentName:"li"},"SAVE_METADATA"),")"),(0,l.kt)("li",{parentName:"ul"},"The state of the request (",(0,l.kt)("inlineCode",{parentName:"li"},"GRANTED"),",",(0,l.kt)("inlineCode",{parentName:"li"},"DENIED"),",",(0,l.kt)("inlineCode",{parentName:"li"},"ERROR")," or ",(0,l.kt)("inlineCode",{parentName:"li"},"SUCCESS"),"),"),(0,l.kt)("li",{parentName:"ul"},"A list of ",(0,l.kt)("inlineCode",{parentName:"li"},"errors")," if any.")),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"To receive these messages, your have to subscribe to this exchange."))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"If AMQP virtual host mode is set to ",(0,l.kt)("inlineCode",{parentName:"p"},"SINGLE"),", this exchange will receive all messages of all tenants! So the receiver may have to filter them according to the tenant he wishes to manage."))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Requests without ",(0,l.kt)("inlineCode",{parentName:"p"},"requestId")," can be routed to AMQP Dead Letter Queue (DLQ) so no response will be published. However, a notification is sent to the administrators of the project in order to tell them to inspect DLQ."))),(0,l.kt)("h4",{id:"example-of-denied-request"},"Example of DENIED request"),(0,l.kt)("p",null,"|:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "requestId": "{requestId}",\n    "requestOwner": "{requestOwner}",\n    "id": "{featureId}",\n    "type": "{requestType}",\n    "state": "DENIED",\n    "errors": ["error1", "error2"]\n}\n')),(0,l.kt)("h4",{id:"example-of-granted-request"},"Example of GRANTED request"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "requestId": "{requestId}",\n    "requestOwner": "{requestOwner}",\n    "id": "{featureId}",\n    "type": "{requestType}",\n    "state": "GRANTED"\n}\n')),(0,l.kt)("h4",{id:"example-of-success-request"},"Example of SUCCESS request"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "requestId": "{requestId}",\n    "requestOwner": "{requestOwner}",\n    "id": "{featureId}",\n    "urn": "{featureGeneratedUrn}",\n    "type": "{requestType}",\n    "state": "SUCCESS"\n}\n')),(0,l.kt)("h4",{id:"example-of-error-request"},"Example of ERROR request"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "requestId": "{requestId}",\n    "requestOwner": "{requestOwner}",\n    "id": "{featureId}",\n    "urn": "{featureGeneratedUrn}",\n    "type": "{requestType}",\n    "state": "ERROR",\n    "errors": ["error1", "error2"]\n}\n')),(0,l.kt)("h3",{id:"for-feature-module"},"...For feature module"),(0,l.kt)("p",null,"Messages are published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.out.FeatureRequestEvent")),(0,l.kt)("h3",{id:"for-featureprovider-module"},"...For featureprovider module"),(0,l.kt)("p",null,"Messages are published on this exchange : ",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.featureprovider.domain.FeatureExtractionResponseEvent")),(0,l.kt)("p",null,"In other words, it means that to migrate from ",(0,l.kt)("strong",{parentName:"p"},"V1.3.x")," to ",(0,l.kt)("strong",{parentName:"p"},"V1.4.0"),", you need to change the exchange to which you subscribe to receive extraction monitoring messages. Or you might be able to configure your AMQP broker to automatically redirect messages from this exchange to the old one (",(0,l.kt)("inlineCode",{parentName:"p"},"regards.broadcast.fr.cnes.regards.modules.feature.dto.event.out.FeatureRequestEvent"),")."))}u.isMDXComponent=!0}}]);