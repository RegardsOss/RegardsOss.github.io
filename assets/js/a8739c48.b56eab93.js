"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[42018],{18210:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var s=i(74848),n=i(28453);const r={title:"Gateway microservice conception",sidebar_label:"How it works",slug:"/development/backend/services/gateway/conception/",sidebar_position:2},o=void 0,a={id:"development/services/gateway/gateway-conception",title:"Gateway microservice conception",description:"Introduction",source:"@site/docs/development/services/gateway/gateway-conception.md",sourceDirName:"development/services/gateway",slug:"/development/backend/services/gateway/conception/",permalink:"/docs/next/development/backend/services/gateway/conception/",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/docs/development/services/gateway/gateway-conception.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Gateway microservice conception",sidebar_label:"How it works",slug:"/development/backend/services/gateway/conception/",sidebar_position:2},sidebar:"dev",previous:{title:"Overview",permalink:"/docs/next/development/backend/services/gateway/overview/"},next:{title:"Overview",permalink:"/docs/next/development/backend/services/fem/overview/"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Filters",id:"filters",level:2},{value:"Route",id:"route",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(t.p,{children:["Gateway microservice uses ",(0,s.jsx)(t.a,{href:"https://cloud.spring.io/spring-cloud-gateway/reference/html/#gateway-how-it-works",children:"Spring Cloud Gateway concept"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Clients send requests to REGARDS. If the Gateway Handler Mapping identifies that a request matches a route, it is forwarded to the Gateway Web Handler. The handler processes the request by passing it through a filter chain specific to the request. All the 'pre' filter logic is executed first, and then the request is routed to service destination. Once this request is sent and a response is received, the 'post' filter logic is executed."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Conception",src:i(95012).A+"",width:"1057",height:"377"})}),"\n",(0,s.jsx)(t.h2,{id:"filters",children:"Filters"}),"\n",(0,s.jsxs)(t.p,{children:["REGARDS has implemented few filters for security, REGARDS ",(0,s.jsx)(t.a,{href:"/docs/next/development/backend/services/authentication/overview/",children:"authentication"})," (internal or external authentication), and monitoring REST requests. As explained in the upper section, these filters are called one by one (with a specified order). These filters can add informations, like user informations, in the request headers."]}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsxs)(t.p,{children:["Several other filters are implemented by spring. ",(0,s.jsx)(t.a,{href:"https://docs.spring.io/spring-cloud-gateway/reference/spring-cloud-gateway/global-filters.html",children:"Check them here"})]}),(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsx)(t.h2,{id:"route",children:"Route"}),(0,s.jsxs)(t.p,{children:["The routing is configured in ",(0,s.jsx)(t.a,{href:"https://github.com/RegardsOss/regards-backend/blob/master/rs-cloud/rs-config/bootstrap-config/src/main/resources-filtered/regards/regards-oss-backend/rs-gateway.properties",children:"rs-gateway.properties file"})," inside ",(0,s.jsx)(t.a,{href:"/docs/next/development/backend/services/config/overview/",children:"rs-config microservice"}),". It explains how the gateway have to redirect requests after the filters has been exectued. This file also contains ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing",children:"CORS"})," informations, and REST response timeout."]}),(0,s.jsx)(t.p,{children:"A classic REGARDS endpoint url respects the pattern :"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"{PROTOCOL}://{HOST}/{PATH_PREFIX}/{MICROSERVICE_NAME}/{ENDPOINT_PATH}\n\nexample:\nhttps://validation-regards.cloud-espace.si.c-s.fr/api/v1/rs-authentication/oauth/token?scope=validation_1_16' \\\n"})}),(0,s.jsx)(t.p,{children:"This url contains two prefixes"}),(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"PATH_PREFIX : api/v1 : permit to have multiple API version. For now, only a V1 exists."}),"\n",(0,s.jsx)(t.li,{children:"MICROSERVICE : rs-authentication : the microservice name"}),"\n"]}),(0,s.jsxs)(t.p,{children:["Gateway makes a call to ",(0,s.jsx)(t.a,{href:"/docs/next/development/backend/services/registry/overview/",children:"rs-registry microservice"})," to know which instance of the microservice send the request (this concept is called load-balancing)."]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},95012:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/gateway-conception-35d872d0541375d177e38ba8440e984c.png"},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var s=i(96540);const n={},r=s.createContext(n);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);