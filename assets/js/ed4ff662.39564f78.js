"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[19026],{27980:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>o});var s=l(74848),n=l(28453);const r={id:"swarm-setup",title:"Inventory configuration",slug:"/setup/swarm/advanced-setup/"},d=void 0,i={id:"setup/playbook/swarm-setup",title:"Inventory configuration",description:"This documentation page may be outdated",source:"@site/versioned_docs/version-2.0.0/setup/playbook/swarm-advanced-setup.md",sourceDirName:"setup/playbook",slug:"/setup/swarm/advanced-setup/",permalink:"/docs/setup/swarm/advanced-setup/",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-2.0.0/setup/playbook/swarm-advanced-setup.md",tags:[],version:"2.0.0",frontMatter:{id:"swarm-setup",title:"Inventory configuration",slug:"/setup/swarm/advanced-setup/"},sidebar:"install",previous:{title:"Tasks",permalink:"/docs/setup/ansible-tasks/"}},c={},o=[{value:"Deployment",id:"deployment",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Users &amp; groups",id:"users--groups",level:3},{value:"Inventories configuration properties",id:"inventories-configuration-properties",level:3}];function x(e){const t={admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsx)(t.p,{children:"This documentation page may be outdated"})}),"\n",(0,s.jsx)(t.h2,{id:"deployment",children:"Deployment"}),"\n",(0,s.jsx)(t.h3,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(t.p,{children:["This page covers some of the possibilities offered by our inventory, specially the\nfile ",(0,s.jsx)(t.code,{children:"regards-playbook/inventories/regards-cnes/group_vars/all/main.yml"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"users--groups",children:"Users & groups"}),"\n",(0,s.jsx)(t.p,{children:"Let's see how users created by the demo inventory are used:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"User"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Group"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Tips"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"dockermapuid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"dockermapgid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Used by the docker daemon"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"This group is internal to the server"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"}}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"gregards_admin"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Regroup all users that are allowed to monitor the stack"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Facultative, ",(0,s.jsx)(t.code,{children:"johndoe"})," can also replace this one"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"docker-regards-data"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"gregards_data"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["IPA User/Group owning all files created by REGARDS, ",(0,s.jsxs)(t.strong,{children:["must be able to access network disk ",(0,s.jsx)(t.code,{children:"group_workdir_network"})]})]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Your user should be inside that group"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"johndoe"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.code,{children:"johndoe"}),", ",(0,s.jsx)(t.code,{children:"dockermapgid"}),", ",(0,s.jsx)(t.code,{children:"gregards_admin"}),", ",(0,s.jsx)(t.code,{children:"gregards_data"})]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Your personnal user"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Your user has access to Docker, to the stack and data"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"mariecurie"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.code,{children:"mariecurie"}),", ",(0,s.jsx)(t.code,{children:"gregards_data"})]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Some user"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"She has access to data, not the stack itself"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"To setup these users and groups, you must follow these requirements:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"User or group"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Value requirement"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"dockermapuid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"name_space_uid"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"dockermapgid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"name_space_gid"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.code,{children:"johndoe"}),",",(0,s.jsx)(t.code,{children:"mariecurie"})]}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Any value inferior to ",(0,s.jsx)(t.code,{children:"name_space_uid"})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"gregards_admin"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Any value inferior to ",(0,s.jsx)(t.code,{children:"name_space_gid"}),". That user can be no login."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"docker-regards-data"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_uid + name_space_uid"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"gregards_data"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_gid + name_space_gid"})})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"inventories-configuration-properties",children:"Inventories configuration properties"}),"\n",(0,s.jsx)(t.p,{children:"Global properties :"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Constraints"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_workdir_network"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Network disk shared accross every nodes"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_workdir_network_allow_root"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Do we allow root inside the network volume?"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_workdir_local"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Local folder where regards is installed on every node"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_stack_name"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Unique stack name (for swarm)"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Required. ",(0,s.jsx)(t.code,{children:"[a-z-]+"})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_setype"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"SELinux type"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_seuser"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"SELinux user"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_root_user"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"User owning the REGARDS folder tree, Docker must have read/write access"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_root_group"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Group owning the REGARDS folder tree"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_enable_setup_regards_users"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Bool"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Do we need to create ",(0,s.jsx)(t.code,{children:"root_group"}),", ",(0,s.jsx)(t.code,{children:"run_group"})," and ",(0,s.jsx)(t.code,{children:"run_user"})," locally ?"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Facultative. Default to true."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_user"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"All files created by containers will use this user"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_group"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"All files created by containers will use this group"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_uid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Int"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Run user id. (See ",(0,s.jsx)(t.code,{children:"group_container_run_user"}),")"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_container_run_gid"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Int"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Run group id. (See ",(0,s.jsx)(t.code,{children:"group_container_run_group"}),")"]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_network_name"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Docker network name. Automatically created by Ansible"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_network_ip_network"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Docker network ip"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Required. If a basic IPV4 looks like ",(0,s.jsx)(t.code,{children:"A.B.C.D"}),", you must provide ",(0,s.jsx)(t.code,{children:"A.B.C."})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_registry"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"String"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Docker registry holding REGARDS images"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"If you don't have mutualised COTS, don't worry. You can deploy yours and use mutualised ones later."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Constraints"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_cots_configuration"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Object"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"List COTS specific configuration"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Required. Can be empty"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_cots_configuration.postgres.nbTenant"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Use to deduce the number of connections Postgres should allow"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Required when ",(0,s.jsx)(t.code,{children:"group_docker_cots.postgres"})," is defined"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_cots_configuration.elasticsearch.cluster_name"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Elasticsearch cluster name"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Required when ",(0,s.jsx)(t.code,{children:"group_docker_cots.elasticsearch"})," is defined"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"group_docker_cots_configuration.elasticsearch_logs.cluster_name"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Logging elasticsearch cluster name"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Required when ",(0,s.jsx)(t.code,{children:"group_docker_cots.elasticsearch_logs"})," is defined"]})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},28453:(e,t,l)=>{l.d(t,{R:()=>d,x:()=>i});var s=l(96540);const n={},r=s.createContext(n);function d(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);