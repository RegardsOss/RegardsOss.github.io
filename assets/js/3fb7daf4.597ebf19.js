"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[98750],{28004:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var t=n(74848),i=n(28453);const r={id:"catalog-protocols-stac-description",title:"Introduction",slug:"/user-guide/catalog/protocols/stac/introduction"},l=void 0,c={id:"user-documentation/catalog-consultation/protocol-stac/catalog-protocols-stac-description",title:"Introduction",description:"Il est possible de configurer un moteur de recherche STAC afin de naviguer sur le catalogue REGARDS en suivant le protocole SpatioTemporal Asset Catalog (STAC).",source:"@site/versioned_docs/version-2.1.0/user-documentation/6-catalog-consultation/protocol-stac/protocol-stac-description.md",sourceDirName:"user-documentation/6-catalog-consultation/protocol-stac",slug:"/user-guide/catalog/protocols/stac/introduction",permalink:"/docs/2.1.0/user-guide/catalog/protocols/stac/introduction",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-2.1.0/user-documentation/6-catalog-consultation/protocol-stac/protocol-stac-description.md",tags:[],version:"2.1.0",frontMatter:{id:"catalog-protocols-stac-description",title:"Introduction",slug:"/user-guide/catalog/protocols/stac/introduction"},sidebar:"manual",previous:{title:"OpenSearch protocol",permalink:"/docs/2.1.0/user-guide/catalog/protocols/opensearch"},next:{title:"Plug-in configuration",permalink:"/docs/2.1.0/user-guide/catalog/protocols/stac/conf-plugin"}},o={},a=[{value:"Limitations des crit\xe8res spatiaux",id:"limitations-des-crit\xe8res-spatiaux",level:4},{value:"Catalogues",id:"catalogues",level:2},{value:"Exemple de requ\xeate curl",id:"exemple-de-requ\xeate-curl",level:4},{value:"Collections",id:"collections",level:2},{value:"Collections statiques",id:"collections-statiques",level:3},{value:"Exemple de requ\xeate curl",id:"exemple-de-requ\xeate-curl-1",level:4},{value:"Collections dynamiques",id:"collections-dynamiques",level:3},{value:"Exemple de requ\xeate curl",id:"exemple-de-requ\xeate-curl-2",level:4},{value:"Items",id:"items",level:2},{value:"Exemple de requ\xeate curl",id:"exemple-de-requ\xeate-curl-3",level:4},{value:"Assets",id:"assets",level:2},{value:"Liens",id:"liens",level:2},{value:"Outils externes",id:"outils-externes",level:2}];function d(e){const s={a:"a",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["Il est possible de configurer un moteur de recherche STAC afin de naviguer sur le catalogue REGARDS en suivant le protocole ",(0,t.jsx)(s.a,{href:"https://stacspec.org/",children:"SpatioTemporal Asset Catalog (STAC)"}),".",(0,t.jsx)(s.br,{}),"\n","L'activation de ce protocole dans REGARDS se fait au travers d'un ",(0,t.jsx)(s.a,{href:"conf-plugin",children:"plug-in de catalogue"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"REGARDS est conforme aux sp\xe9cifications suivantes :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-spec/blob/dev/CHANGELOG.md",children:"STAC spec v1.1.0"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-api-spec/tree/main",children:"STAC API spec v1.0.0"})}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"limitations-des-crit\xe8res-spatiaux",children:"Limitations des crit\xe8res spatiaux"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Dans REGARDS, le param\xe8tre de recherche ",(0,t.jsx)(s.code,{children:"intersects"})," est limit\xe9 aux g\xe9om\xe9tries de type polygone et\nmulti-polygone. La recherche par intersection pour les autres types de g\xe9om\xe9trie n'est pas support\xe9e."]}),"\n",(0,t.jsx)(s.li,{children:"La pr\xe9cision de la grille g\xe9om\xe9trique est de 50 m\xe8tres par d\xe9faut. Pour d\xe9tecter un point, il est donc conseill\xe9\nd'utiliser des polygones ou des bbox d'au moins 100m de c\xf4t\xe9, soit une pr\xe9cision de 0,001\xb0."}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"catalogues",children:"Catalogues"}),"\n",(0,t.jsxs)(s.p,{children:["Un ",(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-api-spec/blob/v1.0.0/stac-spec/catalog-spec/catalog-spec.md",children:(0,t.jsx)(s.strong,{children:"catalogue"})}),"\nest l'entit\xe9 de plus haut niveau dans la sp\xe9cification STAC. Il constitue un ensemble logique de\n",(0,t.jsx)(s.a,{href:"#collections",children:"collections"}),", d'",(0,t.jsx)(s.a,{href:"#items",children:"items"})," et \xe9ventuellement d'autres catalogues."]}),"\n",(0,t.jsx)(s.p,{children:"Dans REGARDS, un catalogue correspond \xe0 un projet. Il n'est pas possible de d\xe9finir plus d'un catalogue par serveur,\net par cons\xe9quent, un seul projet peut exposer ses donn\xe9es au format STAC."}),"\n",(0,t.jsx)(s.h4,{id:"exemple-de-requ\xeate-curl",children:"Exemple de requ\xeate curl"}),"\n",(0,t.jsx)(s.p,{children:"La requ\xeate suivante permet d'obtenir le catalogue STAC:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"curl https://regards.cnes.fr/api/v1/rs-catalog/stac \\\n  -H 'Authorization: Bearer <token>' \\\n  -H 'Accept: application/json'\n"})}),"\n",(0,t.jsx)(s.h2,{id:"collections",children:"Collections"}),"\n",(0,t.jsxs)(s.p,{children:["Une  ",(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-api-spec/blob/v1.0.0/stac-spec/collection-spec/collection-spec.md",children:(0,t.jsx)(s.strong,{children:"collection"})}),"\nest une entit\xe9 de haut niveau dans le protocole STAC. Elle regroupe un ensemble d'objets partageant des\ncaract\xe9ristiques communes."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Attention"})," : Il ne faut pas confondre la notion de collection STAC avec la notion de\n",(0,t.jsx)(s.a,{href:"/docs/2.1.0/user-guide/data-organization/collections-datasets/",children:"collection"})," dans REGARDS."]}),"\n",(0,t.jsx)(s.p,{children:"Dans notre impl\xe9mentation REGARDS, nous distinguons deux types de collections STAC :"}),"\n",(0,t.jsx)(s.h3,{id:"collections-statiques",children:"Collections statiques"}),"\n",(0,t.jsxs)(s.p,{children:["Les ",(0,t.jsx)(s.strong,{children:"collections STAC statiques"})," sont d\xe9finies depuis les ",(0,t.jsx)(s.strong,{children:"jeux de donn\xe9es"})," et les ",(0,t.jsx)(s.strong,{children:"collections"})," de l'instance\nREGARDS.",(0,t.jsx)(s.br,{}),"\n","Une collection statique regroupe un ensemble fixe d'Items, correspondant aux produits du jeu de donn\xe9es ou de la\ncollection REGARDS."]}),"\n",(0,t.jsxs)(s.p,{children:["Le endpoint permettant de visualiser les diff\xe9rentes collections statiques est le suivant :\n",(0,t.jsx)(s.code,{children:"api/v1/rs-catalog/stac/collections/static"})]}),"\n",(0,t.jsx)(s.h4,{id:"exemple-de-requ\xeate-curl-1",children:"Exemple de requ\xeate curl"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"curl https://regards.cnes.fr/api/v1/rs-catalog/stac/collections/static \\\n  -H 'Authorization: Bearer <token>' \\\n  -H 'Accept: application/json'\n"})}),"\n",(0,t.jsx)(s.h3,{id:"collections-dynamiques",children:"Collections dynamiques"}),"\n",(0,t.jsxs)(s.p,{children:["Les ",(0,t.jsx)(s.strong,{children:"collections STAC dynamiques"})," sont cr\xe9\xe9es \xe0 partir des ",(0,t.jsx)(s.strong,{children:"m\xe9tadonn\xe9es"})," des produits de l'instance REGARDS. Plus\nexactement, leur structure est d\xe9termin\xe9e par la liste des ",(0,t.jsx)(s.a,{href:"/docs/2.1.0/user-guide/catalog/protocols/stac/dynamic",children:"champs STAC configur\xe9s dans le plugin"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Les collections dynamiques sont g\xe9n\xe9r\xe9es \xe0 la vol\xe9e en fonction de la valeur dans les items des champs configur\xe9s\ndans le plugin.\nUne notion de niveau de recherche permet d'imbriquer des collections dynamiques dans d'autres.\nCela permet de proposer des m\xe9canismes de recherche adapt\xe9s \xe0 la logique m\xe9tier."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Exemple"})," : dans ma configuration, je peux configurer un champ ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.em,{children:"creationDate"})})," de niveau 1 et un champ\n",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.em,{children:"cloudCover"})})," de niveau 2.\nAlors, \xe0 la racine de mes collections dynamiques, je vais trouver plusieurs collections STAC correspondant \xe0 des\nplages temporelles. Cela me permet de retrouver les items en fonction de leur date de cr\xe9ation.\nA l'int\xe9rieur de chacune de ces collections dynamiques par date, je trouverai une autre liste de\ncollections dynamiques, cette fois-ci correspondant \xe0 des plages de valeurs pour la couverture nuageuse."]}),"\n",(0,t.jsx)(s.h4,{id:"exemple-de-requ\xeate-curl-2",children:"Exemple de requ\xeate curl"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"curl https://regards.cnes.fr/api/v1/rs-catalog/stac/collections/dynamic \\\n  -H 'Authorization: Bearer <token>' \\\n  -H 'Accept: application/json'\n"})}),"\n",(0,t.jsx)(s.h2,{id:"items",children:"Items"}),"\n",(0,t.jsxs)(s.p,{children:["Un ",(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-spec/blob/master/item-spec/json-schema/item.json",children:(0,t.jsx)(s.strong,{children:"item"})})," est l'unit\xe9 de\nbase dans STAC.\nIl repr\xe9sente un artefact spatio-temporel unique, g\xe9n\xe9ralement associ\xe9 \xe0 un moment donn\xe9 (timestamp) et \xe0 une zone\ng\xe9ographique sp\xe9cifique (emprise spatiale).\nDans REGARDS, on peut identifier les items aux diff\xe9rents produits ing\xe9r\xe9s dans le m\xe9ta-catalogue (OAIS et GeoJSON)."]}),"\n",(0,t.jsx)(s.h4,{id:"exemple-de-requ\xeate-curl-3",children:"Exemple de requ\xeate curl"}),"\n",(0,t.jsx)(s.p,{children:"La requ\xeate POST suivante permet de rechercher les items correspondant \xe0 certains crit\xe8res :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:'curl -X POST https://regards.cnes.fr/api/v1/rs-catalog/stac/search \\\n  -H \'Authorization: Bearer <token>\' \\\n  -H \'Accept: application/json\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{ "collections": ["mycollection"], "bbox": [160.6,-55.95,-170,-25.89], "limit": 100, "datetime": \n  "2019-01-01T00:00:00Z/2019-01-01T23:59:59Z" }\'\n'})}),"\n",(0,t.jsx)(s.p,{children:"Il est \xe9galement possible de faire une recherche avec la m\xe9thode GET :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"curl https://regards.cnes.fr/api/v1/rs-catalog/stac/search?bbox=-110,39.5,-105,40.5 \\\n  -H 'Authorization: Bearer <token>' \\\n  -H 'Accept: application/json'\n"})}),"\n",(0,t.jsx)(s.h2,{id:"assets",children:"Assets"}),"\n",(0,t.jsxs)(s.p,{children:["Les ",(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-spec/blob/dev/commons/assets.md",children:(0,t.jsx)(s.strong,{children:"assets"})})," sont les ressources concr\xe8tes\nassoci\xe9es \xe0 un item ou \xe0 une collection. Dans REGARDS, ils sont assimil\xe9s aux fichiers associ\xe9s aux produits OAIS ou\nGeoJSON."]}),"\n",(0,t.jsx)(s.h2,{id:"liens",children:"Liens"}),"\n",(0,t.jsxs)(s.p,{children:["Les ",(0,t.jsx)(s.a,{href:"https://github.com/radiantearth/stac-spec/blob/dev/commons/links.md",children:"liens"})," sont des relations entre des items\net/ou des collections. Par exemple, les collections filles d'une collection sont expos\xe9es aux travers de liens de\ntype ",(0,t.jsx)(s.code,{children:"child"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"outils-externes",children:"Outils externes"}),"\n",(0,t.jsx)(s.p,{children:"Il existe de nombreux clients permettant d'interagir avec des serveurs impl\xe9mentant l'API STAC. Citons parmi ceux-ci :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://radiantearth.github.io/stac-browser",children:"STAC Browser"}),(0,t.jsx)(s.br,{}),"\n","Un navigateur graphique en ligne qui permet de\nparcourir les collections et items."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://pystac-client.readthedocs.io/en/latest/quickstart.html",children:"PyStac Client"}),(0,t.jsx)(s.br,{}),"\n","Un client en ligne de commande \xe9crit en Python qui permet de simplifier l'\xe9criture des requ\xeates vers un serveur STAC."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Tous les clients STAC ont besoin de l'URL du catalogue. Celle-ci peut \xeatre obtenue, ",(0,t.jsx)(s.a,{href:"conf-plugin",children:"une fois le plug-in STAC\nconfigur\xe9"}),", dans l'interface administrateur :"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Cliquer sur la section ",(0,t.jsx)(s.strong,{children:"Acc\xe8s aux donn\xe9es"})]}),"\n",(0,t.jsxs)(s.li,{children:["Dans le panneau ",(0,t.jsx)(s.strong,{children:"Protocoles de recherche"}),", cliquer sur l'ic\xf4ne ",(0,t.jsx)("img",{src:"/images/user-documentation/regards-icons/admin/list.png",alt:"add",height:"25",width:"25"})," ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:"List"})})]}),"\n",(0,t.jsxs)(s.li,{children:["Sur la ligne du protocole STAC, cliquer sur l'ic\xf4ne ",(0,t.jsx)("img",{src:"/images/user-documentation/regards-icons/admin/info.png",alt:"add",height:"25",width:"25"})," ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:"Informations\nd'acc\xe8s"})})]}),"\n",(0,t.jsx)(s.li,{children:"L'URL du catalogue est le premier lien de la liste."}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var t=n(96540);const i={},r=t.createContext(i);function l(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);