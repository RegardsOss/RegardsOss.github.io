"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[81033],{30810:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var s=i(74848),t=i(28453);const o={title:"Download product file API",sidebar_label:"Download product file",slug:"/development/backend/services/catalog/api-guides/rest/download-product-file-api/",sidebar_position:5},d=void 0,r={id:"development/services/catalog/api-guides/rest/download-product-file-api",title:"Download product file API",description:"_This page assumes you know how to authenticate your REST API",source:"@site/versioned_docs/version-2.0.0/development/services/catalog/api-guides/rest/download-product-file-api.md",sourceDirName:"development/services/catalog/api-guides/rest",slug:"/development/backend/services/catalog/api-guides/rest/download-product-file-api/",permalink:"/docs/development/backend/services/catalog/api-guides/rest/download-product-file-api/",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-2.0.0/development/services/catalog/api-guides/rest/download-product-file-api.md",tags:[],version:"2.0.0",sidebarPosition:5,frontMatter:{title:"Download product file API",sidebar_label:"Download product file",slug:"/development/backend/services/catalog/api-guides/rest/download-product-file-api/",sidebar_position:5},sidebar:"dev",previous:{title:"Complex search",permalink:"/docs/development/backend/services/catalog/api-guides/rest/complex-search-api/"},next:{title:"Product file restoration",permalink:"/docs/development/backend/services/catalog/api-guides/rest/file-restoration-api/"}},a={},l=[{value:"Download principle",id:"download-principle",level:2},{value:"Search products and files",id:"search-products-and-files",level:2},{value:"Download file",id:"download-file",level:2},{value:"Endpoint",id:"endpoint",level:3}];function c(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["This page assumes you know how ",(0,s.jsx)(n.a,{href:"/docs/development/backend/services/authentication/api-guides/retrieve-token-oauth2/",children:"to authenticate"})," your REST API\nrequests"]})}),"\n",(0,s.jsx)(n.p,{children:"This section introduces you the API provided by REGARDS to download product files."}),"\n",(0,s.jsx)(n.h2,{id:"download-principle",children:"Download principle"}),"\n",(0,s.jsxs)(n.p,{children:["When a product is available for the user, the user can download it with a request to the ",(0,s.jsx)(n.code,{children:"Catalog"})," service.\nWhen the service receives such a request, several steps are performed:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"First, the service checks the access rights of the product. It ensures that the user has the rights to download the\nproduct and that the license of the dataset of the product has been accepted."}),"\n",(0,s.jsxs)(n.li,{children:["If users has the proper rights and has not reached its download quota, the ",(0,s.jsx)(n.code,{children:"Catalog"})," service calls the ",(0,s.jsx)(n.code,{children:"Storage"}),"\nservice through its REST Client. ",(0,s.jsx)(n.code,{children:"Storage"})," is the microservice responsible for retrieving the product from its\nstorage location."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This guide introduce you ",(0,s.jsx)(n.strong,{children:"2 endpoints"})," related to downloading:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#search-products-and-files",children:"Search products and files"})," gives you the status of the file and where to download it."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#download-file",children:"Download file"})," to download"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"search-products-and-files",children:"Search products and files"}),"\n",(0,s.jsxs)(n.p,{children:["REGARDS offers many ways to search product, you can refer to ",(0,s.jsx)(n.a,{href:"/docs/development/backend/services/catalog/api-guides/rest/legacy-search-api",children:"Search engine guide"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="A nearline product file - standard lucene search engine"',children:'{\n  "id": "URN:FEATURE:DATA:tenant:50fe35a3-e085-3eb1-bb61-86ab3fdeb7dd:V3",\n  "providerId": "DATA-06-20220613-2390",\n  "entityType": "DATA",\n  ...,\n  "files": {\n    "RAWDATA": [\n      {\n        "dataType": "RAWDATA",\n        "reference": false,\n        "uri": "https://regards.host.com/api/v1/rs-catalog/downloads/URN:FEATURE:DATA:tenant:50fe35a3-e085-3eb1-bb61-86ab3fdeb7dd:V3/files/BF39BC048B52618838529D9D98043190",\n        "mimeType": "application/xml",\n        "online": false,\n        "checksum": "BF39BC048B52618838529D9D98043190",\n        "digestAlgorithm": "MD5",\n        "filesize": 190,\n        "filename": "iso.xml",\n        "types": []\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"On every product files returned by standard lucene search engine, you have an"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"online"})," attribute:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"true"})," means the file is always available, and you can ",(0,s.jsx)(n.a,{href:"#download-file",children:"download it"})," without restore it."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"false"})," means the file is ",(0,s.jsx)(n.strong,{children:"nearline"}),", you need\nto ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/development/backend/services/catalog/api-guides/rest/file-restoration-api/",children:"check and restore product files when required"})})," first."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"reference"})," attribute:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"true"})," means the file is provided by another service, external to REGARDS."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"false"})," means REGARDS provides an URI to download the product files."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Reference attribute and authentication",type:"info",children:(0,s.jsxs)(n.p,{children:["Tips : In the response, if ",(0,s.jsx)(n.code,{children:"reference"})," value is ",(0,s.jsx)(n.strong,{children:"true"}),", authentication token is not needed, because file is not\nstored by REGARDS."]})}),"\n",(0,s.jsx)(n.admonition,{title:"Differences between search engines",type:"note",children:(0,s.jsxs)(n.p,{children:["If you don't use the standard lucene search engine (like STAC or OpenSearch), the response does not contain the ",(0,s.jsx)(n.code,{children:"online"}),"\nand ",(0,s.jsx)(n.code,{children:"reference"})," attribute.",(0,s.jsx)(n.br,{}),"\n","It means you need to ",(0,s.jsx)(n.a,{href:"/docs/development/backend/services/catalog/api-guides/rest/file-restoration-api/",children:"check and restore product files when required"})," before trying\nto download."]})}),"\n",(0,s.jsx)(n.h2,{id:"download-file",children:"Download file"}),"\n",(0,s.jsx)(n.h3,{id:"endpoint",children:"Endpoint"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Verb"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"./api-swagger#tag/catalog-download-controller/operation/downloadFile",children:(0,s.jsx)(n.code,{children:"/downloads/{aip_id}/files/{checksum}"})})}),(0,s.jsx)(n.td,{children:"GET"})]})})]}),"\n",(0,s.jsx)(n.p,{children:"Download is possible only if:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["the file is ",(0,s.jsx)(n.a,{href:"file-restoration-api#check-product-availability-endpoint",children:"available"})]}),"\n",(0,s.jsx)(n.li,{children:"user has access right"}),"\n",(0,s.jsx)(n.li,{children:"user didn't reach its download quotas yet."}),"\n",(0,s.jsx)(n.li,{children:"license of the dataset has been accepted (needed if license is not public)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>r});var s=i(96540);const t={},o=s.createContext(t);function d(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);