"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[82848],{68447:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var r=i(74848),o=i(28453);const s={id:"backend-rest-import-notifier-plugin-configuration",title:"Import Notifier plugin configurations",sidebar_label:"Import plugin conf",slug:"/development/backend/notifier/guides/rest/import-plugin-configuration"},t=void 0,l={id:"development/backend/regards/notifier/api-guides/rest/backend-rest-import-notifier-plugin-configuration",title:"Import Notifier plugin configurations",description:"In order to make the configuration simple and easily adjustable, we use the import/export REST API of the microservice.",source:"@site/versioned_docs/version-1.15/development/backend/regards/notifier/api-guides/rest/rest-import-plugins-conf.md",sourceDirName:"development/backend/regards/notifier/api-guides/rest",slug:"/development/backend/notifier/guides/rest/import-plugin-configuration",permalink:"/docs/1.15/development/backend/notifier/guides/rest/import-plugin-configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-1.15/development/backend/regards/notifier/api-guides/rest/rest-import-plugins-conf.md",tags:[],version:"1.15",frontMatter:{id:"backend-rest-import-notifier-plugin-configuration",title:"Import Notifier plugin configurations",sidebar_label:"Import plugin conf",slug:"/development/backend/notifier/guides/rest/import-plugin-configuration"},sidebar:"dev",previous:{title:"Publish a request",permalink:"/docs/1.15/development/backend/services/notifier/guides/amqp/publish-notifier"},next:{title:"REST API",permalink:"/docs/1.15/development/backend/services/notifier/guides/rest/api"}},d={},c=[{value:"Import configuration",id:"import-configuration",level:3},{value:"Request",id:"request",level:3},{value:"Response",id:"response",level:3},{value:"Example of configuration file to import",id:"example-of-configuration-file-to-import",level:4},{value:"Disable a configured rule",id:"disable-a-configured-rule",level:4},{value:"Export configuration",id:"export-configuration",level:3},{value:"Request",id:"request-1",level:3},{value:"Response",id:"response-1",level:3},{value:"Download configuration",id:"download-configuration",level:3}];function a(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"In order to make the configuration simple and easily adjustable, we use the import/export REST API of the microservice."}),"\n",(0,r.jsx)(n.admonition,{type:"danger",children:(0,r.jsxs)(n.p,{children:["Be careful, import will overwrite an existing plugin configuration with same ",(0,r.jsx)(n.code,{children:"business id"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"import-configuration",children:"Import configuration"}),"\n",(0,r.jsx)(n.h3,{id:"request",children:"Request"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"/microservice/configuration"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL template"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"/microservice/configuration"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Method"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"POST"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Headers"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Authorization:Bearer {token}"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Content-Type:multipart/form-data;charset=UTF-8; boundary=6o2knFse3p53ty9dmcQvWAIx1zInP11uCfbm"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Accept:application/json"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Data params"})}),"\n",(0,r.jsxs)(n.p,{children:["Import your configuration file in multipart request using name ",(0,r.jsx)(n.code,{children:"file"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"response",children:"Response"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Code:"})," 201 CREATED"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Configuration parameters :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resetBeforeImport"}),": You can configure to delete all previous configuration before import new one."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RuleMatcher"}),": Configuration of rules based on ",(0,r.jsx)(n.a,{href:"/docs/1.15/development/backend/services/notifier/plugins/rule-matcher",children:"plugins"}),".\nRules are used to define if a notification should be sent to associated RecipientSenders"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RecipientSender"}),": Configuration of notification senders based on ",(0,r.jsx)(n.a,{href:"/docs/1.15/development/backend/services/notifier/plugins/recipient-sender",children:"plugins"}),".\nSenders are used to define how to send notification to recipients."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Rule/RecipientSenders assocation"})," : Configuration to associates one RuleMatcher with one or many RecipientSenders"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "microservice": "rs-notifier",\n  "modules": [\n    {\n      "module": {\n        "id": "notifier"\n      },\n      "resetBeforeImport":  true,\n      "configuration": [...]\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Configure global reset parameter :"}),"\n",(0,r.jsxs)(n.p,{children:["Setting the ",(0,r.jsx)(n.code,{children:"resetBeforeImport"})," parameter to true to reset all previous configuration of notifier before creating the imported one."]}),"\n",(0,r.jsx)(n.p,{children:"Configure plugins (Rule or RecipientSender) :"}),"\n",(0,r.jsx)(n.p,{children:"Add the here under part in the configuration property of the import configuration file :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "key": "fr.cnes.regards.framework.modules.plugins.domain.PluginConfiguration",\n  "value": {\n    "pluginId":"{pluginId}",\n    "label":"{label}",\n    "businessId":"{MyOwnPluginConfiguration}",\n    "version":"1.0.0",\n    "priorityOrder":0,\n    "active":true,\n    "parameters":[\n      {"name":"{parameterName}", "type":"{parameterType}", "value":"{parameterValue}"}\n    ]\n  }\n},\n'})}),"\n",(0,r.jsx)(n.p,{children:"Configure RuleMatcher/RecipientSenders assocation :"}),"\n",(0,r.jsx)(n.p,{children:"Add the here under part in the configuration property of the import configuration file :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "key": "fr.cnes.regards.modules.notifier.dto.conf.RuleRecipientsAssociation",\n  "value": {\n    "ruleId": "{MyRuleMatcher}",\n    "recipientIds": ["{MyRecipient}"]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"example-of-configuration-file-to-import",children:"Example of configuration file to import"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "microservice": "rs-notifier",\n  "modules": [\n    {\n      "module": {\n        "id": "notifier"\n      },\n      "resetBeforeImport": true,\n      "configuration": [\n        {\n          "key": "fr.cnes.regards.framework.modules.plugins.domain.PluginConfiguration",\n          "value": {\n            "pluginId": "RabbitMQSender",\n            "label": "RabbitMQ Sender",\n            "businessId": "RabbitMQSender",\n            "version": "1.0.0",\n            "priorityOrder": 0,\n            "active": true,\n            "parameters": [\n              {\n                "name": "exchange",\n                "type": "STRING",\n                "value": "regards.geode-validation"\n              },\n              {\n                "name": "queueName",\n                "type": "STRING",\n                "value": "regards.geode-validation"\n              }\n            ]\n          }\n        },\n        {\n          "key": "fr.cnes.regards.framework.modules.plugins.domain.PluginConfiguration",\n          "value": {\n            "pluginId": "DefaultRuleMatcher",\n            "label": "Rule by type",\n            "businessId": "RuleByType",\n            "version": "1.0.0",\n            "priorityOrder": 0,\n            "active": true,\n            "parameters": [\n              {\n                "name": "attributeValueToSeek",\n                "type": "STRING",\n                "value": "L0A_LR_Packet"\n              },\n              {\n                "name": "attributeToSeek", \n                "type": "STRING",\n                "value": "type"\n              }\n            ]\n          }\n        },\n        {\n          "key": "fr.cnes.regards.modules.notifier.dto.conf.RuleRecipientsAssociation",\n          "value": {\n            "ruleId": "RuleByType",\n            "recipientIds": ["RabbitMQSender"]\n          }\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"disable-a-configured-rule",children:"Disable a configured rule"}),"\n",(0,r.jsxs)(n.p,{children:["In order to disable a configured rule you can import the same configuration file changing the ",(0,r.jsx)(n.code,{children:"active"})," value from true to false."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "microservice": "rs-notifier",\n  "modules": [\n    {\n      "module": {\n        "id": "notifier"\n      },\n      "resetBeforeImport": false,\n      "configuration": [\n        {\n          "key": "fr.cnes.regards.framework.modules.plugins.domain.PluginConfiguration",\n          "value": {\n            "pluginId": "DefaultRuleMatcher",\n            "label": "Rule by type",\n            "businessId": "RuleByType",\n            "version": "1.0.0",\n            "priorityOrder": 0,\n            "active": false,\n            "parameters": [\n              {\n                "name": "attributeValueToSeek",\n                "type": "STRING",\n                "value": "L0A_LR_Packet"\n              },\n              { "name": "attributeToSeek", "type": "STRING", "value": "type" }\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"export-configuration",children:"Export configuration"}),"\n",(0,r.jsx)(n.h3,{id:"request-1",children:"Request"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"/microservice/configuration"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL template"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"/microservice/configuration"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Method"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"GET"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Headers"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Authorization:Bearer {token}"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Content-Type:application/json;charset=UTF-8"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Accept:application/json"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Data params"})}),"\n",(0,r.jsx)(n.p,{children:"None"}),"\n",(0,r.jsx)(n.h3,{id:"response-1",children:"Response"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Code:"})," 200 OK"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Headers:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin:*"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Methods:POST, PUT, GET, OPTIONS, DELETE"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Headers:authorization, content-type, scope"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Access-Control-Max-Age:3600"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Content-Type:application/json"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:'Content-Disposition:attachment; filename="config-Test application.json"'}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"X-Content-Type-Options:nosniff"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"X-XSS-Protection:1; mode=block"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Cache-Control:no-cache, no-store, max-age=0, must-revalidate"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Pragma:no-cache"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"Expires:0"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"X-Frame-Options:DENY"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Content:"})}),"\n",(0,r.jsx)(n.p,{children:"Template :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "microservice": "{microservice name}",\n  "modules": [\n    {\n      "module": {\n        "id": "{module id}",\n        "name": "{module name}",\n        "description": "{module description}",\n        "version": "{module version}",\n        "author": "{module author}",\n        "legalOwner": "{module owner}",\n        "documentation": "{module docu url}"\n      },\n      "configuration": [\n        {\n          "key": "{fully qualified class name}",\n          "value": "{json}"\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"download-configuration",children:"Download configuration"}),"\n",(0,r.jsx)(n.p,{children:"To get configuration as a link, simply pass token in URL as follow :"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"/microservice/configuration?token={bearer}"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Method"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"GET"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(96540);const o={},s=r.createContext(o);function t(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);