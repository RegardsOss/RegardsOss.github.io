"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[28255],{31115:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var s=t(74848),i=t(28453);const o={title:"How it works",sidebar_label:"How it works",slug:"/development/services/access-instance/conception",sidebar_position:2},r=void 0,a={id:"development/services/access-instance/conception",title:"How it works",description:"Introduction",source:"@site/docs/development/services/access-instance/conception.md",sourceDirName:"development/services/access-instance",slug:"/development/services/access-instance/conception",permalink:"/docs/next/development/services/access-instance/conception",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/docs/development/services/access-instance/conception.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"How it works",sidebar_label:"How it works",slug:"/development/services/access-instance/conception",sidebar_position:2},sidebar:"dev",previous:{title:"Overview",permalink:"/docs/next/development/services/access-instance/overview"},next:{title:"All endpoints (OpenAPI)",permalink:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/"}},d={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Module : uiconfiguration",id:"module--uiconfiguration",level:2},{value:"Module : toponyms-instance",id:"module--toponyms-instance",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"rs-access-instance"})," microservice is composed of two distinct modules in order to configure instance administration\nweb UI."]}),"\n",(0,s.jsx)(n.h2,{id:"module--uiconfiguration",children:"Module : uiconfiguration"}),"\n",(0,s.jsxs)(n.p,{children:["This module allows to handle the configuration of the Regards user interface with CRUD operations on the database\nconcerning the UI widgets, layout and themes for portal interface. This module is also used in the ",(0,s.jsx)(n.code,{children:"rs-access-project"}),"\nmicroservice. All these graphical elements are stored in the database of Regards instance."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Endpoints in order to handle the configuration\nof ",(0,s.jsx)(n.a,{href:"/docs/next/development/frontend/packages/lazy-modules/",children:"UI module"})," for user's\nUI : ",(0,s.jsx)(n.a,{href:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/#tag/module-controller",children:"Module Controller"})]}),"\n",(0,s.jsxs)(n.li,{children:["Endpoints in order to handle the configuration\nof ",(0,s.jsx)(n.a,{href:"/docs/next/development/frontend/view/theme/",children:"UI theme"})," for user's\nUI : ",(0,s.jsx)(n.a,{href:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/#tag/theme-controller",children:"UI Theme Controller"})]}),"\n",(0,s.jsxs)(n.li,{children:["Endpoints in order to handle the configuration\nof ",(0,s.jsx)(n.a,{href:"/docs/next/development/frontend/configuration/layout/",children:"UI layout"})," for user's\nUI : ",(0,s.jsx)(n.a,{href:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/#tag/ui-layout-controller",children:"UI Layout Controller"})]}),"\n",(0,s.jsxs)(n.li,{children:["Endpoints in order to handle the UI\nconfiguration : ",(0,s.jsx)(n.a,{href:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/#tag/ui-layout-controller",children:"UI Configuration Controller"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"module--toponyms-instance",children:"Module : toponyms-instance"}),"\n",(0,s.jsx)(n.p,{children:"A toponym is a geographic location, such as a town, region or country identified by a label.\nThe PostGIS extension is added in the PostgreSQL database. PostGIS extends the capabilities of the PostgreSQL relational\ndatabase by adding support for storing, indexing, and querying geospatial data."}),"\n",(0,s.jsxs)(n.p,{children:["This module allows to store and to retrieve toponyms in the database thanks to a REST API (\nsee ",(0,s.jsx)(n.a,{href:"/docs/next/development/services/access-instance/api-guides/rest/api-swagger/#tag/toponyms-controller",children:"API GUIDES"}),")."]}),"\n",(0,s.jsx)(n.p,{children:"List of endpoints :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Retrieve all toponyms (only visible toponyms, with geometry) with pagination from the database"}),"\n",(0,s.jsxs)(n.li,{children:["Get a toponym (by default, with geometry : ",(0,s.jsx)(n.code,{children:"simplified=false"}),") by its business identifier from the database. If\nthe ",(0,s.jsx)(n.code,{children:"simplified"})," parameter is true, the geometry is not contained in the returned toponym."]}),"\n",(0,s.jsx)(n.li,{children:"Search a toponym thanks to a partial label from the database. Geometries are not retrieved and list content is limited\nto 100 toponyms. By default only visible toponyms are retrieved. If the partial label is empty, retrieve the list of\ntoponyms (only visible toponyms, with geometry) limited to 100."}),"\n",(0,s.jsx)(n.li,{children:"Create a new toponym in the database, visible only for a user (number of created toponym limited by user and by day :\nsee configuration). The new toponym has a expiration date of 1 day."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"At the starting of microservice, a list of toponyms concerning countries is loaded in the database of Regards thanks to\nthe SQL script.\nTo add new toponyms in the database of Regards, you can use :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"a SQL script :"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"INSERT INTO ${flyway:defaultSchema}.t_toponyms (\"geom\" , \"bid\", \"label\", \"label_fr\", \"copyright\") \nVALUES (\n   public.ST_SetSRID('0103000000010000000B000000FEFFFF7F767851C0350000007DD22840FAFFFFBF9A7C51C0E7FFFF9F92DF2840FFFFFF3FC78351C03600002096142940FBFFFF7FD18351C0500000E06B412940020000E01F8251C007000000963C2940FDFFFFBFA97B51C0220000405D0E2940FDFFFFBF677951C0120000C02FF62840FAFFFFBF0C7951C0F5FFFFFFC6F1284004000000AD7851C0280000C061EA2840FDFFFFBFFD7751C0080000209FD42840FEFFFF7F767851C0350000007DD22840'::public.GEOMETRY,4326), \n   'Aruba', \n   'Aruba', \n   'Aruba', \n   'arcgis'\n);\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["a command line tool nammed ",(0,s.jsx)(n.a,{href:"https://gdal.org/programs/ogr2ogr.html",children:"ogr2ogr"})," that converts one Ogr defined data source\nto another Ogr data source. Ogr supports many data formats here is a subset of the ones we commonly use: ESRI\nShapefile, MapInfo Tab file, CSV, DBF, GML, KML, Interlis, SQLite, GeoPackage,SpatiaLite, ODBC, ESRI GeoDatabase (MDB\nformat), ESRI GDB database, PostGIS/PostgreSQL."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The following script allows to insert toponym in the database of Regards thanks to a shapefile."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'gr2ogr -f "PostgreSQL" \\\n-update -append \\\n-skipfailures \\\n-lco FID=id \\\n-lco SCHEMA=toponyms \\\n-nln toponyms.t_toponyms \\\n"PG:host=<host> user=<login> password=<password> dbname=<dbname>" \\\n-lco GEOMETRY_NAME=geom \\\n-sql "SELECT <label from shape file> AS label, <label from shape file> AS label_fr, \\\n     <copiright from shape file> AS copyright, <unique identifier from shape file> AS bid FROM <shapeFile>"  \\\n-lco PRECISION=no -nlt PROMOTE_TO_MULTI \\\n<shapeFile>.shp\n'})}),"\n",(0,s.jsx)(n.p,{children:"Structure of table(name: t_toponyms) of database in order to define a toponym in Regards :"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Column"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"bid"}),(0,s.jsx)(n.td,{children:"varchar(50) not null UNIQUE (primary key)"}),(0,s.jsx)(n.td,{children:"Business identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"label"}),(0,s.jsx)(n.td,{children:"varchar(256) NOT NULL"}),(0,s.jsx)(n.td,{children:"Label of toponym"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"label_fr"}),(0,s.jsx)(n.td,{children:"varchar(256) NOT NULL"}),(0,s.jsx)(n.td,{children:"Label of toponym (in french)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"copyright"}),(0,s.jsx)(n.td,{children:"varchar(512)"}),(0,s.jsx)(n.td,{children:"Copyright of toponym"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"description"}),(0,s.jsx)(n.td,{children:"varchar(512)"}),(0,s.jsx)(n.td,{children:"Description of toponym"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"geom"}),(0,s.jsx)(n.td,{children:"public.geometry(Geometry,4326)"}),(0,s.jsx)(n.td,{children:"Geometry information SRID=4326 (PostGIS)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"visible"}),(0,s.jsx)(n.td,{children:"boolean DEFAULT true"}),(0,s.jsx)(n.td,{children:"Visibility of toponym in IHM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"creation_date"}),(0,s.jsx)(n.td,{children:"timestamp DEFAULT CURRENT_TIMESTAMP"}),(0,s.jsx)(n.td,{children:"Date of creation of toponym in database"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"expiration_date"}),(0,s.jsx)(n.td,{children:"timestamp"}),(0,s.jsx)(n.td,{children:"Date of expiration of toponym in database"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"project"}),(0,s.jsx)(n.td,{children:"varchar(256)"}),(0,s.jsx)(n.td,{children:"Name of project for the toponym"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"author"}),(0,s.jsx)(n.td,{children:"varchar(100)"}),(0,s.jsx)(n.td,{children:"Author for the toponym"})]})]})]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"A scheduler is defined to clean old toponyms in the database; if the toponym is not visible and its expiration date is\npassed."})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);