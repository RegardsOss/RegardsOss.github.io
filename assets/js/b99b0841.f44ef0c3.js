"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[34464],{36873:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>c,toc:()=>o});var r=t(74848),n=t(28453);const d={id:"backend-amqp-get-product-progress",title:"Subscribe to products events",sidebar_label:"Subscribe to products events",sidebar_position:2,slug:"/development/backend/services/lta-manager/guides/get-product-progress-amqp"},i=void 0,c={id:"development/services/lta-manager/api-guides/amqp/backend-amqp-get-product-progress",title:"Subscribe to products events",description:"Introduction",source:"@site/docs/development/services/lta-manager/api-guides/amqp/amqp-get-product-progress.md",sourceDirName:"development/services/lta-manager/api-guides/amqp",slug:"/development/backend/services/lta-manager/guides/get-product-progress-amqp",permalink:"/docs/development/backend/services/lta-manager/guides/get-product-progress-amqp",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/docs/development/services/lta-manager/api-guides/amqp/amqp-get-product-progress.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"backend-amqp-get-product-progress",title:"Subscribe to products events",sidebar_label:"Subscribe to products events",sidebar_position:2,slug:"/development/backend/services/lta-manager/guides/get-product-progress-amqp"},sidebar:"dev",previous:{title:"Create product",permalink:"/docs/development/backend/services/lta-manager/guides/submit-product-amqp"},next:{title:"Create product",permalink:"/docs/development/backend/services/lta-manager/guides/create-product-rest"}},l={},o=[{value:"Introduction",id:"introduction",level:2},{value:"Regards AMQP api",id:"regards-amqp-api",level:2},{value:"Exchange",id:"exchange",level:2},{value:"Queue",id:"queue",level:2},{value:"Message format",id:"message-format",level:2},{value:"Properties",id:"properties",level:3},{value:"Headers",id:"headers",level:3},{value:"Granted response",id:"granted-response",level:3},{value:"Success response",id:"success-response",level:3},{value:"Invalid request responses",id:"invalid-request-responses",level:3},{value:"Internal error responses",id:"internal-error-responses",level:3}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(s.p,{children:["This section describes how to subscribe to events sent by rs-lta-manager microservice about submitted products\nrequests as described in ",(0,r.jsx)(s.a,{href:"/docs/development/backend/services/lta-manager/guides/submit-product-amqp",children:"Create Product guide"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["After your ",(0,r.jsx)(s.a,{href:"/docs/development/backend/services/lta-manager/guides/submit-product-amqp",children:"Submission request"})," is sent, you will receive :"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["A ",(0,r.jsx)(s.strong,{children:"GRANTED"})," or a ",(0,r.jsx)(s.strong,{children:"DENIED"})," response to inform you if your request has been accepted or not."]}),"\n",(0,r.jsxs)(s.li,{children:["A ",(0,r.jsx)(s.strong,{children:"SUCCESS"})," or an ",(0,r.jsx)(s.strong,{children:"ERROR"})," response to inform you that your request has been processed."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Requests and responses are linked with a correlation identifier ",(0,r.jsx)(s.strong,{children:"correlationId"})," that is provided into submission\nrequests and added in service responses."]}),"\n",(0,r.jsx)(s.h2,{id:"regards-amqp-api",children:"Regards AMQP api"}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.a,{href:"/docs/development/concepts/amqp-api/",children:"Regards AMQP API concept"})," describe how AMQP interfaces must be handled to\nsubmit events or to subscribe to events."]}),"\n",(0,r.jsx)(s.h2,{id:"exchange",children:"Exchange"}),"\n",(0,r.jsx)(s.p,{children:"Product submission responses from REGARDS are sent to exchange :"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Exchange"}),(0,r.jsx)(s.th,{children:"Virtual host"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"regards.broadcast.fr.cnes.regards.modules.ltamanager.amqp.output.SubmissionResponseDtoEvent"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"regards.multitenant.manager"})})]})})]}),"\n",(0,r.jsx)(s.h2,{id:"queue",children:"Queue"}),"\n",(0,r.jsxs)(s.p,{children:["Every consumer of this\nexchange ",(0,r.jsx)(s.a,{href:"/docs/development/concepts/amqp-api/#subscribe-to-regards-published-events",children:"must create its own queue bound to this exchange"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"message-format",children:"Message format"}),"\n",(0,r.jsx)(s.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"app_id"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{children:"Standard RabbitMQ property to track message origin."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"priority"}),(0,r.jsx)(s.td,{children:"Integer"}),(0,r.jsx)(s.td,{children:"Standard RabbitMQ property to sort messages by priority order."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"content_encoding"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{children:"Standard RabbitMQ property for the encoding type of the message"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"content_type"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{children:"Standard RabbitMQ property for the MIME Type of the message sent"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"delivery_mode"}),(0,r.jsx)(s.td,{children:"Integer"}),(0,r.jsx)(s.td,{children:"Standard RabbitMQ property for the delivery mode (persistent or not)"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"headers",children:"Headers"}),"\n",(0,r.jsx)(s.p,{children:"Headers are the same for all kind of responses."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"regards.tenant"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.a,{href:"/docs/development/concepts/multitenant/",children:"Tenant"})," name depends on REGARDS instance project configuration."]})]})})]}),"\n",(0,r.jsx)(s.h3,{id:"granted-response",children:"Granted response"}),"\n",(0,r.jsx)(s.p,{children:"REGARDS will publish a granted notification on the response exchange when the request is validated."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "correlationId": "xxx",\n  "productId": "xxx",\n  "responseStatus": "GRANTED"\n}\n'})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{style:{textAlign:"center"},children:"Optional"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"correlationId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request identifier"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"productId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Id of the product to create"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"responseStatus"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Status of the request. More details below."})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"success-response",children:"Success response"}),"\n",(0,r.jsx)(s.p,{children:"REGARDS will publish a success notification on the response exchange when the request is terminated in success."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "correlationId": "xxx",\n  "productId": "xxx",\n  "responseStatus": "SUCCESS",\n  "expires": "2022-12-22T10:25:52.243Z",\n  "session": "xxx",\n  "message": ""\n}\n'})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{style:{textAlign:"center"},children:"Optional"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"correlationId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request identifier"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"productId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Id of the product to create"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"responseStatus"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Status of the request. More details below."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"expires"}),(0,r.jsx)(s.td,{children:"String Date ISO 8601"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsxs)(s.td,{children:["Request expiration date. Format yyyy-MM-dd'T'HH:mm",":ss",".SSSZ"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"session"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request session name"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"message"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(s.td,{children:"Information message about your request"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"invalid-request-responses",children:"Invalid request responses"}),"\n",(0,r.jsx)(s.p,{children:"REGARDS will publish a denied notification on the response exchange when the request is not valid."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "correlationId": "xxx",\n  "productId": "xxx",\n  "responseStatus": "DENIED",\n  "message": ""\n}\n'})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{style:{textAlign:"center"},children:"Optional"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"correlationId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request identifier"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"productId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Id of the product to create"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"responseStatus"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Status of the request. More details below."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"message"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(s.td,{children:"Information message about your request"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"A request can be invalid, if :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Request is not well formed"}),"\n",(0,r.jsx)(s.li,{children:"Provided datatype is unknown or not configured."}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{title:"How to handle it?",type:"info",children:(0,r.jsx)(s.p,{children:"Look at your request, fix it and submit a new one."})}),"\n",(0,r.jsx)(s.h3,{id:"internal-error-responses",children:"Internal error responses"}),"\n",(0,r.jsx)(s.p,{children:"After request has been granted by REGARDS, internal errors may occur. In such case, an error response will be published\non the response exchange."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "correlationId": "xxx",\n  "productId": "xxx",\n  "responseStatus": "ERROR",\n  "expires": "2022-12-22T10:25:52.243Z",\n  "session": "xxx",\n  "message": "Cause of the internal error"\n}\n'})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{style:{textAlign:"center"},children:"Optional"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"correlationId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request identifier"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"productId"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Id of the product to create"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"responseStatus"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Status of the request. More details below."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"expires"}),(0,r.jsx)(s.td,{children:"String Date ISO 8601"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsxs)(s.td,{children:["Request expiration date. Format yyyy-MM-dd'T'HH:mm",":ss",".SSSZ"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"session"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(s.td,{children:"Request session name"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"message"}),(0,r.jsx)(s.td,{children:"String"}),(0,r.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(s.td,{children:"Information message about your request"})]})]})]}),"\n",(0,r.jsx)(s.admonition,{title:"How to handle it?",type:"info",children:(0,r.jsx)(s.p,{children:"Retry later with new request or contact REGARDS administrators."})})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>c});var r=t(96540);const n={},d=r.createContext(n);function i(e){const s=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),r.createElement(d.Provider,{value:s},e.children)}}}]);