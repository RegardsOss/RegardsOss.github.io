"use strict";(self.webpackChunkregardsoss_github_io=self.webpackChunkregardsoss_github_io||[]).push([[70177],{51810:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var t=r(74848),o=r(28453);const s={title:"LTA-MANAGER microservice conception",sidebar_label:"How it works",slug:"/development/backend/services/lta-manager/conception/",sidebar_position:2},i=void 0,a={id:"development/services/lta-manager/lta-manager-conception",title:"LTA-MANAGER microservice conception",description:"Introduction",source:"@site/docs/development/services/lta-manager/lta-manager-conception.md",sourceDirName:"development/services/lta-manager",slug:"/development/backend/services/lta-manager/conception/",permalink:"/docs/next/development/backend/services/lta-manager/conception/",draft:!1,unlisted:!1,editUrl:"https://github.com/RegardsOss/RegardsOss.github.io/edit/master/docs/development/services/lta-manager/lta-manager-conception.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"LTA-MANAGER microservice conception",sidebar_label:"How it works",slug:"/development/backend/services/lta-manager/conception/",sidebar_position:2},sidebar:"dev",previous:{title:"Overview",permalink:"/docs/next/development/backend/services/lta-manager/overview/"},next:{title:"Create product",permalink:"/docs/next/development/backend/services/lta-manager/guides/submit-product-amqp"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Data types",id:"data-types",level:2},{value:"Versioning",id:"versioning",level:2},{value:"Worker Manager configuration",id:"worker-manager-configuration",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["LTA Manager is used to simplify data ingestion. To do so,\nLTA use a datatype configuration. It allows to associate a label (datatype name) to a configuration (\nsee ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/lta-manager/configuration/import-export",children:"LTA Manager configuration"}),")."]}),"\n",(0,t.jsx)(n.p,{children:"The submission requests must indicate a datatype to let LTA Manager knows which configuration use.\nOtherwise, the request will be denied."}),"\n",(0,t.jsxs)(n.p,{children:["The main purpose of the microservice is to transfer product creation requests to the ",(0,t.jsx)(n.code,{children:"rs-worker-manager"})," service.\nThe product will then be transformed into a SIP and sent to the ",(0,t.jsx)(n.code,{children:"rs-ingest"})," service using a\ndedicated ",(0,t.jsx)(n.a,{href:"/docs/next/development/concepts/workers/",children:"worker"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To learn how to submit product creation request to the ",(0,t.jsx)(n.code,{children:"LTA Manager"})," microservice, please refer to\nthe ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/lta-manager/guides/submit-product-amqp",children:"AMQP API Guide"}),"\nand ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/lta-manager/guides/create-product-rest",children:"REST API Guide"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"LTA request are stored in database, and status requests can be followed from admin UI (Admin/LTA Manager)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"conception_diagram.png",src:r(33742).A+"",width:"1096",height:"880"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"We've illustrated an error on the Worker side, but you can also have an error on the Ingestion step and on the Storage\nstep."})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"lta-sip-generation-worker"})," will not be explained in this documentation section but is mandatory to generate SIPs."]})}),"\n",(0,t.jsx)(n.h2,{id:"data-types",children:"Data types"}),"\n",(0,t.jsxs)(n.p,{children:["Every ",(0,t.jsx)(n.a,{href:"/docs/next/development/concepts/products/",children:"product"})," submitted to the ",(0,t.jsx)(n.code,{children:"LTA Manager"})," microservice must define a *\n",(0,t.jsx)(n.em,{children:"Data Type"}),"*."]}),"\n",(0,t.jsx)(n.p,{children:"The Data Type concept is the main concept enabling the microservice to know how to process the product creation request."}),"\n",(0,t.jsx)(n.p,{children:"All Data Types must be configured on the service in order to define for each one :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.a,{href:"/docs/next/development/concepts/meta-catalog/",children:"data model"})," used to validate the product"]}),"\n",(0,t.jsx)(n.li,{children:"The sub-directory for storing the files associated with the product in the long-term archive."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"versioning",children:"Versioning"}),"\n",(0,t.jsxs)(n.p,{children:["Versioning of products is the same as describe in the ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/ingest/conception/#versioning",children:"rs-ingest documentation"}),".\nNevertheless, only two versioning methods are available with ",(0,t.jsx)(n.code,{children:"LTA Manager"}),", ",(0,t.jsx)(n.strong,{children:"REPLACE"})," and ",(0,t.jsx)(n.strong,{children:"INC_VERSION"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["When you submit a creation request you can provide a parameter to choose the versioning mode. Please refer to\nthe ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/lta-manager/guides/submit-product-amqp",children:"AMQP Guide"})," and\nthe ",(0,t.jsx)(n.a,{href:"/docs/next/development/backend/services/lta-manager/guides/create-product-rest",children:"Rest API Guide"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"worker-manager-configuration",children:"Worker Manager configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"lta-manager"})," service can only operate if the ",(0,t.jsx)(n.code,{children:"worker-manager"})," service is properly configured.\nIndeed, ",(0,t.jsx)(n.code,{children:"lta-manager"})," delegates the product creation requests to ",(0,t.jsx)(n.code,{children:"worker-manager"}),", which is responsible for starting the\nappropriate workers."]}),"\n",(0,t.jsxs)(n.p,{children:["For general instructions on how to configure the worker-manager service, refer to the\n",(0,t.jsx)(n.a,{href:"/docs/development/services/worker-manager/configuration/import_export",children:"Worker Manager configuration section"})]}),"\n",(0,t.jsx)(n.p,{children:"This workflow involves two specific workers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"lta-product-zip-extraction-worker"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"lta-sip-generator-worker"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["You must therefore configure two ",(0,t.jsx)(n.code,{children:"workerType"})," entries corresponding to these workers, as well as a ",(0,t.jsx)(n.code,{children:"workflowType"})," that\ndefines their execution sequence."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:"title='rs-worker-manager configuration for lta workers example'",children:'{\n  "microservice": "rs-worker-manager",\n  "modules": [\n    ...\n      "configuration": [\n        {\n          "key": "fr.cnes.regards.modules.workermanager.dto.WorkflowConfigDto",\n          "value": {\n            "workflowType": "lta-request",\n            "steps": [\n              {\n                "stepNumber": 1,\n                "workerType": "lta-product-zip-extraction-worker"\n              },\n              {\n                "stepNumber": 2,\n                "workerType": "lta-sip-generator-worker"\n              }\n            ]\n          }\n        },\n        {\n          "key": "fr.cnes.regards.modules.workermanager.dto.WorkerConfigDto",\n          "value": {\n            "workerType": "lta-product-zip-extraction-worker",\n            "contentTypeInputs": [\n              "lta-to-extract-request"\n            ],\n            "contentTypeOutput": "lta-extracted-request"\n          }\n        },\n        {\n          "key": "fr.cnes.regards.modules.workermanager.dto.WorkerConfigDto",\n          "value": {\n            "workerType": "lta-sip-generator-worker",\n            "contentTypeInputs": [\n              "lta-extracted-request"\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},33742:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/conception_diagram-8ad6b6b692e901a9525ae68621d2dcc5.png"},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(96540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);