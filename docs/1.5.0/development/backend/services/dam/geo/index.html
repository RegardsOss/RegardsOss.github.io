<!doctype html>
<html class="docs-version-1.5.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="search" type="application/opensearchdescription+xml" title="REGARDS" href="/opensearch.xml"><title data-react-helmet="true">Geospatial features management | REGARDS</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://RegardsOss.github.io//docs/1.5.0/development/backend/services/dam/geo/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="1.5.0"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-1.5.0"><meta data-react-helmet="true" property="og:title" content="Geospatial features management | REGARDS"><meta data-react-helmet="true" name="description" content="REGARDS supports geospatial search on Earth, Mars and celestial dome."><meta data-react-helmet="true" property="og:description" content="REGARDS supports geospatial search on Earth, Mars and celestial dome."><link data-react-helmet="true" rel="icon" href="/img/logos/regards-png/regards-favicon.png"><link data-react-helmet="true" rel="canonical" href="https://RegardsOss.github.io//docs/1.5.0/development/backend/services/dam/geo/"><link data-react-helmet="true" rel="alternate" href="https://RegardsOss.github.io//docs/1.5.0/development/backend/services/dam/geo/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://RegardsOss.github.io//docs/1.5.0/development/backend/services/dam/geo/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3fcf0228.css">
<link rel="preload" href="/assets/js/runtime~main.f3f91723.js" as="script">
<link rel="preload" href="/assets/js/main.ca2b77b0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logos/regards-svg/regards-white.svg" alt="Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logos/regards-svg/regards-white.svg" alt="Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">REGARDS</b></a><a class="navbar__item navbar__link" href="/docs/1.5.0/setup/">Install</a><a class="navbar__item navbar__link" href="/docs/1.5.0/user-guide/">Manual</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/1.5.0/development/">Developers</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/1.5.0/setup/">1.5.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/development/backend/services/dam/geo/">1.8.0</a></li><li><a class="dropdown__link" href="/docs/1.7.1/development/backend/services/dam/geo/">1.7.1</a></li><li><a class="dropdown__link" href="/docs/1.6.0/development/backend/services/dam/geo/">1.6.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/1.5.0/development/backend/services/dam/geo/">1.5.0</a></li><li><a class="dropdown__link" href="/docs/1.4.0/development/backend/dam/geo/">1.4.0</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><a class="navbar__item navbar__link" href="/roadmap/">Roadmap</a><a class="navbar__item navbar__link" href="/release-notes/">Release notes</a><a class="navbar__item navbar__link" href="/aboutus/">About us</a><a href="https://github.com/RegardsOss/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/1.5.0/development/">Development manual</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/1.5.0/development/backend/architecture/concepts/">Backend</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/architecture/concepts/">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/framework/getting-started/">Framework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/1.5.0/development/backend/services/overview/">Services</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/1.5.0/development/backend/services/overview/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/authentication/overview/">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/admin/overview/">Admin project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/access/overview/">Access project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/catalog/overview/">Catalog</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/overview/">Data management</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/overview/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/api/access-rights/">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/plugins/data-access-rights/">Plugins</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/events/">Bus message events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/1.5.0/development/backend/services/dam/geo/">Geospatial features management</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/fem/overview/">Feature manager</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/notifier/overview/">Notifier</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/dataprovider/overview/">Data provider</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/ingest/overview/">Ingest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/order/overview/">Order</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/processing/overview/">Processing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/1.5.0/development/backend/services/storage/overview/">Storage</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/1.5.0/development/frontend/introduction/setup/">Frontend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/1.5.0/development/tutorials/overview/">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/1.5.0/development/appendices/oais/">Appendices</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->REGARDS<!-- --> <b>1.5.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/development/backend/services/dam/geo/">latest version</a></b> (<!-- -->1.8.0<!-- -->).</div></div><div class="docItemContainer_vinB"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->1.5.0</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Geospatial features management</h1></header><p>REGARDS supports geospatial search on Earth, Mars and celestial dome.</p><p>GeoJson format is internally used both by REGARDS and by ElasticSearch.</p><p>By now, some restrictions exist concerning applied geometries, search capabilities and geospatial projections.</p><p>Everything has been done to make use of API as easy as possible but it is necessary to fully understand underlying mechanisms of both data storage and searching to avoid border cases drawbacks.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="regards-search-capabilities">REGARDS Search capabilities<a class="hash-link" href="#regards-search-capabilities" title="Direct link to heading">â€‹</a></h2><p>By now, REGARDS must be able to search geometric features into or accross a specified circle and a convex polygon on Earth, Mars and for astronomic perfect sphere.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="spatial-projection">Spatial Projection<a class="hash-link" href="#spatial-projection" title="Direct link to heading">â€‹</a></h2><p>REGARDS takes advantage of Elasticsearch powerful geometry search but this has a cost: Elasticsearch only uses WGS84 coordinate system, ie classic Earth cylindric projection (in particular used by GPS) where Earth is assimilated to an ellipsoid flattened on poles. This means that for Mars and astronomic search, it is necessary to transform input point coordinates into WGS84 equivalent coordinates to permit use of Elasticsearch geometric search so each geometry feature is both saved as is (with its specified crs) and saved transformed into WGS84 crs.</p><p>It is advisable that aim of REGARDS is to search intersections between geometries, not compute distances or areas for example which is fully compatible with projections transformations.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="mars">Mars<a class="hash-link" href="#mars" title="Direct link to heading">â€‹</a></h3><p>Mars is also an ellipsoid flattened on poles with a slightly flattening difference and an approximate half radius. Concerning polygon search it is enough to transform searching polygon into WGS84 crs and do the search with that geometry. For circle search, it is more complex:  </p><ul><li>because of flattening difference between Earth an Mars, a circle on Mars is not a circle on Earth except if center is a pole or on equator,</li><li>thanks to ellipsoid symmetry and using Geotools API, it is easy to find upper and lower circle points on projected circle, </li><li>with these two points, an inner circle and outer circle can be used: all geometries into inner circle can be taken, all geometries out of outer circle can be evicted</li><li>for all geometries between inner and outer circles, minimum distance from circle center is directly computed with Geotools using input Mars coordinates to determine if geometries can be taken or not.</li><li><strong>minimum distance computation from a point (circle center) and a polygon is done by computing distance between all edges of polygon lines and nine more points on all these lines</strong> (this provides an acceptable approximation and knowing that, it is easy to increase precision by adding polygon points).</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="astro">Astro<a class="hash-link" href="#astro" title="Direct link to heading">â€‹</a></h3><p>Astronomic data are saved taking into account right ascension as a longitude and declination as a latitude, all in degrees. These geometries are then projected into a perfect sphere with medium earth radius (also known as authalic sphere).<br>
<!-- -->Same algorithm as Mars one is then used.<br>
<!-- -->The only difference is that to specify a circle for circle search, <strong>half-angle of the cone in degrees</strong> is specified in place of the radius.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="geojson-format">GeoJSON format<a class="hash-link" href="#geojson-format" title="Direct link to heading">â€‹</a></h2><p>Geometry objects are described internally with GeoJSON format following RFC 7946 (<a href="https://tools.ietf.org/html/rfc7946" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc7946</a>). This specification permits to defines following geometry objects:</p><ul><li>Point</li><li>MultiPoint</li><li>LineString</li><li>MultiLinesString</li><li>Polygon</li><li>MultiPolygon  </li></ul><p>Please, refer directly to given link for more precisions.<br>
<!-- -->It is advisable to carefully read and understand:</p><ul><li>Polygon build especially linear ring right hand rule concept.</li><li>Antimeridian Cutting.</li></ul><p><strong>Note:</strong> by now, concerning polygons, only convex ones without holes are taken into account by REGARDS.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="geometry-normalization">Geometry normalization<a class="hash-link" href="#geometry-normalization" title="Direct link to heading">â€‹</a></h2><p>Despite RFC 7946, not all applications completely follows it especially when antimeridian line is crossed. It is the case of Elasticsearch.
Furthermore, WGS84 is not designated to function with poles because it is a cylindrical projection.<br>
<!-- -->Even RFC 7946 lets some shadow zones, in this case REGARDS had made a choice for taking into account some cases explained lower.<br>
<!-- -->To counter all these drawbacks and make a consistent implementation, REGARDS provides a normalization for all geometries to manage a larger part of borderline problems.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="coordinate-ranges">Coordinate Ranges<a class="hash-link" href="#coordinate-ranges" title="Direct link to heading">â€‹</a></h3><ul><li>Coordinates (longitude and latitude) are explained into <strong>degrees</strong>.</li><li>Latitude is expressed from <strong>-90Â°</strong> to <strong>+90Â°</strong>.</li><li>Longitude is expressed from <strong>-180Â°</strong> (included) to <strong>+180Â°</strong> (excluded) but exceptionally a negative longitude could be expressed from <strong>+180Â°</strong> (included) to <strong>+360Â°</strong> (excluded) as discussed lower.</li><li>As WGS84 is a cylindrical projection, poles - which are simple points with latitude <strong>90Â°</strong> or <strong>-90Â°</strong> without taking into account longitude value - are <em>transformed</em> into lines with longitude varying from <strong>-180Â°</strong> to <strong>+180Â°</strong> (or <strong>360Â°</strong> in some cases), this permits to deal with convex polygon around poles (see lower).</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="bounding-box">Bounding box<a class="hash-link" href="#bounding-box" title="Direct link to heading">â€‹</a></h3><p>A Bounding box (aka Bbox) is not a geometry object but is used as a search criterion parameter (opensearch norm).<br>
<!-- -->A bounding box is always expressed with 4 values: southwest corner longitude, southwest corner latitude, northeast corner longitude, northeast corner latitude.<br>
<!-- -->RFC 7946 says that the latitude of the northeast corner is always greater than the latitude of the southwest corner except when bounding boxes crosses the antimeridian. This means that<br>
<code>&quot;bbox&quot;: [177.0, -20.0, -178.0, -16.0]</code><br>
<!-- -->should cover 5 degrees of longitude.
Unfortunately, Elasticsearch is not able to take this into consideration, so in this case, the Bbox criterion is replaced by:<br>
<code>&quot;bbox&quot;: [177.0, -20.0, 180.0, -16.0] OR &quot;bbox&quot;: [-180.0, -20.0, -178.0, -16.0]</code>  </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="linestring-and-multilinestring">LineString and MultiLineString<a class="hash-link" href="#linestring-and-multilinestring" title="Direct link to heading">â€‹</a></h3><p>Elasticsearch forgets to be clever when taken into account line strings this means for a string crossing antimeridian, it does not use shortest path and always use the path crossing 0-longitude meridian.<br>
<!-- -->LineString normalization consists to first determine if strings cross antimeridian (<strong>as a simplification, algorithm only check longitudes distances to 0-meridian line and antimeridian, as if string edges where projected on equator, and then chooses short path between both edges</strong>) and if so, transforms LineString into MultiLineString cutting input LineString at antimeridian.<br>
<!-- -->For example:<br>
<code>LINE_STRING((100, 50), (-100, 0))</code><br>
<!-- -->is transformed into<br>
<code>MULTI_LINE_STRING(</code><br>
<!-- -->Â <!-- -->Â <code>LINE_STRING((100, 50), (180, 25)),</code><br>
<!-- -->Â <!-- -->Â <code>LINE_STRING((-180, 25), (-100, 0))</code><br>
<code>)</code><br>
<!-- -->Of course, MultiLineString LineStrings components are all normalized and aggregated to produce normalized MultiLineString.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="polygon-and-multipolygon">Polygon and MultiPolygon<a class="hash-link" href="#polygon-and-multipolygon" title="Direct link to heading">â€‹</a></h3><p>Polygons are the most complex geometries to normalize because of varieties (convex, concave, around poles) and difficulty to properly be analysed, don&#x27;t forget that a geo polygon is a polygon on a sphere not just on a plane.<br>
<strong>First, note that by now, only <em>simple</em> polygons are taken into account, ie convex and without holes</strong>. However it is possible to ingest complex Polygons or MultiPolygons but no normalization is applied.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="linear-ring">Linear ring<a class="hash-link" href="#linear-ring" title="Direct link to heading">â€‹</a></h4><p>Following RFC 7946, a polygon is composed of several linear rings. First one is the exterior ring, others are holes into exterior ring. A linear ring is a closed LineString with four or more positions, first and last ones must be the same.</p><p>It is <strong>mandatory</strong> to describe a polygon following right <strong>hand rule</strong> so exterior ring is described counterclockwise and holes clockwise. Don&#x27;t forget that polygons belong to a sphere, this means that every polygon has a complementary polygon and the only way to discriminate them is to follow this rule.</p><p>For example:<br>
<code>POLYGON(((0, 80), (90, 80), (-90, 80), (0, 80)))</code><br>
<!-- -->is a cap around North pole else<br>
<code>POLYGON(((0, 80), (-90, 80), (90, 80), (0, 80)))</code><br>
<!-- -->is a (huge) cap around South pole.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="normalization-algorithm">Normalization algorithm<a class="hash-link" href="#normalization-algorithm" title="Direct link to heading">â€‹</a></h4><ul><li><p>First, some polygons may have a large amplitude exceeding 180Â° or 270Â°. Most of frameworks or software are not able to manage correctly such polygons because shortest distance between two point when crossing antimeridian is not well managed. To avoid this, first step of normalization is to use the fact that Elasticsearch is able to manage longitudes between -180Â° and 180Â° but also longitudes from 180Â° to 360Â° (excluded). Despite a path between 170Â° and -170Â° is not considered as going through antimeridian, same path between 170Â° and 190Â° is considered as going through antimeridian. Algorithm then analyzes each polygon linear strings and eventualy modifies longitudes following shortest path (same computation as LineString one).<br>
<strong>=&gt; This means that it&#x27;s a good thing to start a large amplitude polygon with its westmost point as first element.</strong></p></li><li><p>Second, some polygons may contain North or South pole (or both) as a cap on 80Â° latitude for example (<code>POLYGON(((0, 80), (90, 80), (-90, 80), (0, 80)))</code>).<br>
<!-- -->Into WGS84 crs, this polygon is just a line between <code>(-90, 80)</code> and <code>(90, 80)</code>. A circle search centered on North pole with a radius lower than 10Â° (ie more than 1000 km) will not found previously given polygon.<br>
<!-- -->To make this fully functional with WGS84, algorithm exploits the fact that Elasticsearch takes into account all longitudes at 90Â° latitude (as if North and South pole were strings and not just a single point). After having determined that polygon is around a pole using Hipparchus framework (<a href="https://www.hipparchus.org" target="_blank" rel="noopener noreferrer">https://www.hipparchus.org</a>), a polygon reaching North pole using complete longitude amplitude is added on top of current polygon.<br>
<!-- -->Previous polygon normalization is then:
<code>POLYGON((0, 80), (90, 80), (180, 80), (180, 90), (-180, 90), (-180, 80), (-90, 80), (0, 80))</code>.</p></li></ul><p>In theory, a convex polygon containing both poles should be well normalized but it would be a good idea to use a MultiPolygon intersecting initial polygon with equator.</p><p>Of course, MultiPolygon Polygons components are all normalized and aggregated to produce normalized MultiPolygon.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-1.5.0/development/backend/regards/dam/geo.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/1.5.0/development/backend/services/dam/events/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bus message events</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/1.5.0/development/backend/services/fem/overview/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#regards-search-capabilities" class="table-of-contents__link toc-highlight">REGARDS Search capabilities</a></li><li><a href="#spatial-projection" class="table-of-contents__link toc-highlight">Spatial Projection</a><ul><li><a href="#mars" class="table-of-contents__link toc-highlight">Mars</a></li><li><a href="#astro" class="table-of-contents__link toc-highlight">Astro</a></li></ul></li><li><a href="#geojson-format" class="table-of-contents__link toc-highlight">GeoJSON format</a></li><li><a href="#geometry-normalization" class="table-of-contents__link toc-highlight">Geometry normalization</a><ul><li><a href="#coordinate-ranges" class="table-of-contents__link toc-highlight">Coordinate Ranges</a></li><li><a href="#bounding-box" class="table-of-contents__link toc-highlight">Bounding box</a></li><li><a href="#linestring-and-multilinestring" class="table-of-contents__link toc-highlight">LineString and MultiLineString</a></li><li><a href="#polygon-and-multipolygon" class="table-of-contents__link toc-highlight">Polygon and MultiPolygon</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container_grid_bQnQ"><div class="col_1_KTIr"><p><strong>A framework and a set of plugins to build scientific archives.</strong></p><p>REGARDS is an Open Source data valorization product, highly flexible to various themes, modular, efficient, long-lasting, evolutionary and scalable, aims at providing services to Mission Centers and laboratories, and is able to deal with huge amount of data. <br>Our goal is to allow a strong commitment from user community in the development of modules and plugins.</p><p><strong>We welcome <a href="https://github.com/RegardsOss/RegardsOss.github.io/blob/master/CONTRIBUTING.md">your contributions</a> to make these documents better.</strong></p><div><img src="/img/logos/courbe-institutionnelle-signature_y110-inverser.png"></div></div><div class="col_2_Jonb"><h4 class="footer__title">Users</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/user-guide/">Manual</a></li></ul></div><div class="col_2_Jonb"><h4 class="footer__title">Developpers</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/setup/">Install</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/development/backend/architecture/concepts/">Backend</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/development/frontend/introduction/setup/">Frontend</a></li></ul></div><div class="col_2_Jonb"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/RegardsOss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 REGARDS, OSS. Built with Docusaurus.</div></div></footer></div>
<script src="/assets/js/runtime~main.f3f91723.js"></script>
<script src="/assets/js/main.ca2b77b0.js"></script>
</body>
</html>