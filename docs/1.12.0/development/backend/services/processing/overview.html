<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.12.0 plugin-docs plugin-id-default docs-doc-id-development/backend/regards/processing/backend-processing-overview" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">REGARDS processing microservice | REGARDS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://RegardsOss.github.io/docs/1.12.0/development/backend/services/processing/overview"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.12.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.12.0"><meta data-rh="true" name="docsearch:version" content="1.12.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.12.0"><meta data-rh="true" property="og:title" content="REGARDS processing microservice | REGARDS"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/logos/regards-png/regards-favicon.png"><link data-rh="true" rel="canonical" href="https://RegardsOss.github.io/docs/1.12.0/development/backend/services/processing/overview"><link data-rh="true" rel="alternate" href="https://RegardsOss.github.io/docs/1.12.0/development/backend/services/processing/overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://RegardsOss.github.io/docs/1.12.0/development/backend/services/processing/overview" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BP0ACDVAUR-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="REGARDS" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.9310f71f.css">
<link rel="preload" href="/assets/js/runtime~main.06899180.js" as="script">
<link rel="preload" href="/assets/js/main.624bd5d5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logos/regards-svg/regards-white.svg" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logos/regards-svg/regards-white.svg" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">REGARDS</b></a><a class="navbar__item navbar__link" href="/docs/1.12.0/setup">Install</a><a class="navbar__item navbar__link" href="/docs/1.12.0/user-guide">Manual</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/1.12.0/development">Developers</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/1.12.0/setup">1.12.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/development/backend/services/processing/overview">1.15</a></li><li><a class="dropdown__link" href="/docs/development/backend/services/processing/overview">1.14</a></li><li><a class="dropdown__link" href="/docs/1.13.0/development/backend/services/processing/overview">1.13.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/1.12.0/development/backend/services/processing/overview">1.12.0</a></li><li><a class="dropdown__link" href="/docs/1.11.0/development/backend/services/processing/overview">1.11.0</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/release-notes">Release notes</a><a class="navbar__item navbar__link" href="/aboutus">About us</a><a href="https://github.com/RegardsOss/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS darkNavbarColorModeToggle_X3D1" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/1.12.0/development">Development manual</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/1.12.0/development/backend/architecture/concepts">Backend</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/architecture/concepts">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/framework/getting-started">Framework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/1.12.0/development/backend/services/overview">Services</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/1.12.0/development/backend/services/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/access/overview">Access project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/admin/overview">Admin project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/authentication/overview">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/catalog/overview">Catalog</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/dam/overview">Data management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/fem/overview">Feature manager</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/notifier/overview">Notifier</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/dataprovider/overview">Data provider</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/ingest/overview">Ingest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/order/overview">Order</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/1.12.0/development/backend/services/processing/overview">Processing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/1.12.0/development/backend/services/processing/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/1.12.0/development/backend/services/processing/api-swagger">API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/processing/api/process">API (legacy)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/processing/plugins">Plugins</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/storage/overview">Storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/worker-manager/overview">Worker Manager</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/1.12.0/development/backend/services/lta-manager/overview">LTA Manager</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/1.12.0/development/frontend/introduction/setup">Frontend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/1.12.0/development/tutorials/overview">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/1.12.0/development/appendices/oais">Appendices</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->REGARDS<!-- --> <b>1.12.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/development/backend/services/processing/overview">latest version</a></b> (<!-- -->1.14<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Backend</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Services</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Processing</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Overview</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.12.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>REGARDS processing microservice</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>The main reason for <code>Processing</code> is to apply treatments to ordered data files,
before they are served to the end user. However, this microservice has been
designed to be able to do more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="processing-architecture">Processing architecture<a href="#processing-architecture" class="hash-link" aria-label="Direct link to Processing architecture" title="Direct link to Processing architecture">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="domain-entities">Domain entities<a href="#domain-entities" class="hash-link" aria-label="Direct link to Domain entities" title="Direct link to Domain entities">​</a></h3><p>There are five main entities introduced by <code>Processing</code>. Since their names are
rather generic and semantically overloaded, they are prefixed by a <code>P</code> referring
to the &quot;<code>P</code>&quot;rocessing context.</p><p> <img loading="lazy" alt="Domain entities" src="/assets/images/domain_entities-15d72851b1398dbf64bbc6abea400082.png" width="224" height="392" class="img_ev3q"></p><p>Before describing each of the entities in more details, here is the very crude
idea behind this architecture:</p><ul><li>a <code>PProcess</code> describes a program to be run on data, the program can be configured
with parameters,</li><li>a <code>PBatch</code> describes a logical group of executions of a <code>PProcess</code>, providing
values for the program configuration parameters,</li><li>a <code>PExecution</code> describes the launch of the program on data, providing the actual
input files,</li><li>a <code>PInputFile</code> the description of a file to be used during an execution (it is
actually a glorified URL pointing to some data),  </li><li>a <code>PStep</code> is en event occuring during an execution (flagging the execution as
running, in success or in failure),</li><li>a <code>POutputFile</code> is a result of an execution, and may refer to the <code>PInputFile</code>s
which were used to build it.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pprocess"><code>PProcess</code><a href="#pprocess" class="hash-link" aria-label="Direct link to pprocess" title="Direct link to pprocess">​</a></h4><p>At the top of the abstraction hierarchy is the <code>PProcess</code>. A <code>PProcess</code> is the
abstract description of a procedure to be applied to one or many files.</p><p>The <code>PProcess</code> has several expected attribute:</p><ul><li>an UUID,</li><li>a name,</li><li>a set of metadata named the &quot;process info&quot;.</li></ul><p>It also provides more specific attributes:</p><ul><li>a size forecast, allowing to predict before launching execution, the expected
quantity of data outputted for a given input size,</li><li>a duration forecast, allowing to predict the expected duration of treatment,
allowing to compute a timeout duration for each execution,</li><li>a mapper from output to input, telling how to assign the corresponding inputs
to a given output,</li><li>validators for <code>PBatch</code> and <code>PExecution</code> creation using this <code>PProcess</code>,
allowing to decide in advance if the process may be used in a given context,</li><li>a workload engine and an executable, describing what and how to run the
corresponding program ; these mechanism will be explained below.</li></ul><p><code>PProcess</code> is an interface, and there is a default basic concrete class
<code>ConcretePProcess</code> implementing it as a simple POJO. However, any type of class
could implement <code>PProcess</code>, depending on the final application.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pbatch"><code>PBatch</code><a href="#pbatch" class="hash-link" aria-label="Direct link to pbatch" title="Direct link to pbatch">​</a></h3><p>A user has data to process, and has chosen a <code>PProcess</code> to treat them.
In order to launch treatments (also called executions), the user must
first acquire a <code>PBatch</code>, by calling the <code>Processing</code> service and providing:</p><ul><li>the <code>PProcess</code> configuration parameter values to be used by all executions</li><li>statistics regarding the quantity of data to treat.</li></ul><p>This allows the <code>Processing</code> service to decide whether the treatments
can be done or not. For instance, some configuration parameter values might
be wrong, or some quota of use may be reached. This validation is done
using the <code>PProcess</code> batch validator.</p><p>If the batch validator accepts the information, it delivers a <code>PBatch</code>
instance, saved in the <code>Processing</code> service database. This batch has:</p><ul><li>an ID,</li><li>a correlation ID given by the user when requesting the creation of the batch,
which will be provided for any execution result later,</li><li>the values for the <code>PProcess</code> parameters which will be used by all the
executions launched in the context of this batch.</li></ul><p>A batch is an immutable entity: it never changes once it has been created.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="abusing-batches-is-possible">Abusing batches is possible<a href="#abusing-batches-is-possible" class="hash-link" aria-label="Direct link to Abusing batches is possible" title="Direct link to Abusing batches is possible">​</a></h4><p>Once the batch has been created and delivered to the user, the user may use
it and abuse it. Theere is for now no limitation of the number of executions
a user can do using the same batch ID. This limitation is not enforced because
sometimes, the input statistics provided at the batch creation may be
slightly inexact, and it is hard to predict in advance how many executions
will be needed to treat all the data. Instead of making bad heuristics,
the choice has been made to trust the user to not abuse the system, especially
since for now the only user for <code>Processing</code> is the <code>Order</code> service, which
has no interest in abusing batches.</p><p>However, if <code>Processing</code> had to be accessed directly by end users in the future,
it will require to enforce a more strict policy regarding the execution creation
within a given batch.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pexecution"><code>PExecution</code><a href="#pexecution" class="hash-link" aria-label="Direct link to pexecution" title="Direct link to pexecution">​</a></h3><p>When the user has received the batch response providing the batch ID, the
user can send execution request to <code>Processing</code>, using an AMQP
<code>PExecutionRequestEvent</code> message.</p><p>The execution request contains:</p><ul><li>the batch ID it corresponds to (determining the configuration parameters
for the <code>PProcess</code>),</li><li>the list of <code>PInputFile</code> to use as input data for this execution,</li><li>an execution correlation ID, which will be provided back when <code>Processing</code>
returns the execution result (as an AMQP <code>PExecutionResultEvent</code>).</li></ul><p>When the <code>Processing</code> service receives the request, it validates it using the
<code>PProcess</code> execution validator, and if accepted, saves it in the service
database and then runs it, using the <code>PProcess</code> executable and workload engine.</p><p>A <code>Pexecution</code> is a mutable entity: while running the executable, <code>PStep</code>s are
emmitted and added to the <code>PExecution</code>, providing a current status and last update
timestamp for the execution.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pinputfile"><code>PInputFile</code><a href="#pinputfile" class="hash-link" aria-label="Direct link to pinputfile" title="Direct link to pinputfile">​</a></h3><p>A <code>PInputFile</code> is an input file descriptor, defining:</p><ul><li>where the file is located using an URL,</li><li>the file size/content type/checksum,</li><li>a file-specific correlation ID, which will be used when reporting back
the execution result, allowing to map output files back to the input file
correlation IDs which were used to generate the output file.</li></ul><p>A <code>PInputFile</code> is an immutable entity.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pstep"><code>PStep</code><a href="#pstep" class="hash-link" aria-label="Direct link to pstep" title="Direct link to pstep">​</a></h3><p>While running in the context of an execution, the process-supplied <code>IExecutable</code>
has access to en event notifier, allowing to inform the <code>Processing</code> service
that steps have occurred in the execution.</p><p>A <code>PStep</code> is an immutable entity with the following fields:</p><ul><li>a status defining the type of step (RUNNING, SUCCESS, FAILURE, etc.).</li><li>an optional set of output files used if the step is final.</li></ul><p>An execution status can be transitory of final. Final statuses are:</p><ul><li>SUCCESS, </li><li>FAILURE, </li><li>and TIMED_OUT. </li></ul><p>Once a final status is reached, the execution is considered finished and
the <code>PExecutionResultEvent</code> is created and sent to the AMQP broker.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="poutputfile"><code>POutputFile</code><a href="#poutputfile" class="hash-link" aria-label="Direct link to poutputfile" title="Direct link to poutputfile">​</a></h3><p>When a <code>PStep</code> is final, it is supposed to contain a list of output results,
in the form of <code>POutputFile</code>s.</p><p>A <code>POutputFile</code> is, like the <code>PInputFile</code>, a wrapper around an URL. It has:</p><ul><li>an ID,</li><li>a reference to the corresponding execution UUID,</li><li>a file name, URL, size and checksum,</li><li>a list of optional <code>PInputFile</code> correlation IDs, allowing to make reference
to the input which generated this output.</li></ul><p>The <code>POutputFile</code> is mutable and also has a few technical flags:</p><ul><li><code>downloaded</code> tells if the file has been downloaded by the client,</li><li><code>deleted</code> tells if the file has been deleted and is not present for download anymore.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="general-algorithm">General algorithm<a href="#general-algorithm" class="hash-link" aria-label="Direct link to General algorithm" title="Direct link to General algorithm">​</a></h2><p>Here is a description of the way a client needs to interact with <code>Processing</code> in order
to launch executions. (Only the &#x27;happy path&#x27; is represented.)</p><p><img loading="lazy" alt="General &amp;#39;Happy Path&amp;#39; Algorithm" src="/assets/images/general_algo-8d5685189a211455dc7fd9ab88b79462.png" width="1204" height="1656" class="img_ev3q"></p><p>The client needs to interact first with the REST API in order to get the <code>PProcess</code>
details and then create a <code>PBatch</code>.</p><p>Then, the user needs to send <code>PExecution</code> requests events through AMQP.</p><p>The <code>Processing</code> service then launches the work using the workload engine for
the corresponding process, which launches an executable (provided by the process).</p><p>Running the executable generates steps, which are notified using a step notifier present
in the execution context which is given to the executable.</p><p>When the notifier receives a final step (step with a final <code>ExecutionStatus</code>), it
generates an execution result event sent back to the client though AMQP.</p><p>The final step contains references to the output files generated during the
execution. The user is free to download them by whichever means it has. Once
the download is done, the user notifies <code>Processing</code> through AMQP of the
downloaded files. <code>Processing</code> marks them as downloaded.</p><p>A scheduled service runs at a given periodicity to take all the output files
marked as downloaded, and delete them from the shared storage space where they
have been stored, and marks the output files as deleted in the database.</p><p>A scheduled service runs at a given periodicity to take all the batches for
which all the executions have been finished for a given duration, and deletes them
from the database. This deletion cascades to all the executions, steps, and output
files linked to this batch.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-details">Technical details<a href="#technical-details" class="hash-link" aria-label="Direct link to Technical details" title="Direct link to Technical details">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="workload-engine--executable--execution-context">Workload engine / executable / execution context<a href="#workload-engine--executable--execution-context" class="hash-link" aria-label="Direct link to Workload engine / executable / execution context" title="Direct link to Workload engine / executable / execution context">​</a></h3><p>This section describes the why and how of the workload engine,
and the mechanism by which executables notify execution events.</p><p>The <code>Processing</code> service is an empty shell. It does not run the processes
itself, but delegates the running to the workload engine referenced by a <code>PProcess</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="generalities-on-workload-engines">Generalities on workload engines<a href="#generalities-on-workload-engines" class="hash-link" aria-label="Direct link to Generalities on workload engines" title="Direct link to Generalities on workload engines">​</a></h4><p>The <code>WorkloadEngine</code> responsibility is then to define how the <code>IExecutable</code>
defined by the process will be launched (which could be synchronously,
in a separate thread, in a different virtual machine, etc.).
A <code>WorkloadEngine</code> is a way to abstract the running of processes. It is an
interface to frameworks like REGARDS jobs, Spring Batch, etc. whose purpose
is to launch programs on demand.</p><p>A <code>WorkloadEngine</code> instance has a name, and references itself when loaded
at bootstrap in a <code>WorkloadEngineRepository</code>. A <code>PProcess</code> will provide
the name of the engine it is supposed to run on.</p><p>When an execution of the <code>PProcess</code> is started, the service will load the
corresponding <code>WorkloadEngine</code>. For instance, in the case of the deployment
of <code>Processsing</code> for launching treatments on orders, the <code>WorkloadEngine</code> used
by all processes is for now based on REGARDS jobs. Launching an execution
with this engine is just creating a <code>LaunchingExecutionJob</code> as <code>QUEUED</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="executionevent"><code>ExecutionEvent</code><a href="#executionevent" class="hash-link" aria-label="Direct link to executionevent" title="Direct link to executionevent">​</a></h4><p>An execution event signifies that something happened during an execution.
The execution event contains an optional <code>PStep</code> (which may be final or not)
and an optional list of <code>POutputFiles</code>. The event can signify that a step
has been reached, or that output files have been generated, or both.</p><p>(In the context of the use of <code>Processing</code> for order data treatment, the
processes must send output files only along with a final step, but this
is a limitation given by the context of use, rather than a limitation of
the domain as it is designed.)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iexecutioneventnotifier"><code>IExecutionEventNotifier</code><a href="#iexecutioneventnotifier" class="hash-link" aria-label="Direct link to iexecutioneventnotifier" title="Direct link to iexecutioneventnotifier">​</a></h4><p>The <code>IExecutionEventNotifier</code> interface defines how to deal with events
sent during an execution. It is a simple functional interface which takes
as input an <code>ExecutionEvent</code> and returns a <code>Mono&lt;PExecution&gt;</code>
(with the steps potentially updated with the event step). (The <code>Mono</code> wrapper
signifies that a side-effect has been done during the execution, for instance
a modification of the execution in the database.)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="executioncontext"><code>ExecutionContext</code><a href="#executioncontext" class="hash-link" aria-label="Direct link to executioncontext" title="Direct link to executioncontext">​</a></h4><p>An <code>ExecutionContext</code> provides access to:</p><ul><li>the <code>PProcess</code> and <code>PBatch</code> corresponding to the execution,</li><li>an <code>IExecutionEventNotifier</code>,</li><li>a mutable map of metadata.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iexecutable"><code>IExecutable</code><a href="#iexecutable" class="hash-link" aria-label="Direct link to iexecutable" title="Direct link to iexecutable">​</a></h4><p>An <code>IExecutable</code> is a function which takes as input an <code>ExecutionContext</code> and
returns a <code>Mono&lt;ExecutionContext&gt;</code>. The <code>Mono</code> wrapper signifies that
side effects may occur. </p><p><code>IExecutable</code>s are simple functions which can be chained, allowing for
compositionality and modularity. Simple executable steps can be aggregated
into more complex executables.</p><p>These functions are meant to do side effects, and use the input <code>ExecutionContext</code>&#x27;s
event notifier, in order to advance steps or signify that outputs have been
generated. </p><p>An <code>IExecutable</code> is not supposed to know anything about the workload engine
that runs it, but it practise some information can be passed by the workload
engine to the executable through the <code>ExecutionContext</code> metadata.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reactive-first-service">Reactive-first service<a href="#reactive-first-service" class="hash-link" aria-label="Direct link to Reactive-first service" title="Direct link to Reactive-first service">​</a></h3><p>The <code>Processing</code> microservice has been identified as a potential bottleneck
with heavy load. Because it might also be often prompted for monitoring
information, the choice has been made to make this microservice with a
reactive stack, using Spring Webflux and Netty as the backbone.</p><p>However, in the context of REGARDS, and because there is a lot of
security configuration inherited from REGARDS, the service can be
(and has been) configured to run in a servlet context, backed by Jetty.</p><p>It should be beneficial to the service to remain in a reactive-first
logic, especially in its domain core. The reactive model permeates throughout
the code in the form of function from values to <code>Mono</code>s and <code>Flux</code>es of
values. (Clean code often tends to leave such frameworks out of the
domain, but it is very hard to do so with Reactor ; especially since
the underlying interfaces do not discriminate between single-valued publishers
and multi-valued ones, and typing everything as <code>Publisher</code> is not helpful.)</p><p>As for the REST controllers, two versions are provided: a reactive and
a servlet one.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clean-architecture">Clean architecture<a href="#clean-architecture" class="hash-link" aria-label="Direct link to Clean architecture" title="Direct link to Clean architecture">​</a></h3><p>The <code>Processing</code> service is based on &#x27;Clean Architecture&#x27; principles.
This means that it has a domain core and several adapters, which abstract away
the different ways to interact with the external world.</p><p>The core defines:</p><ul><li>the base entities describes above,</li><li>the interfaces for services and repositories to manage the entities.</li></ul><p>The main adapters are:</p><ul><li>database access,</li><li>event handlers,</li><li>process management,</li><li>workload engine.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="database-access-adapter">Database access adapter<a href="#database-access-adapter" class="hash-link" aria-label="Direct link to Database access adapter" title="Direct link to Database access adapter">​</a></h4><p>This adapter uses a reactive dirver (r2dbc) and is not destined to be reimplemented
for another context, unless there is a need to connect to something else than
postgresql.</p><p>In order to allow <code>Processing</code> to be run effectively in all contexts, and
in order to allow imitations on <code>PProcess</code>, the choice has been made to
use the reactive driver R2DBC to the database.</p><p>This allows to use <code>Processing</code> in a reactive context without suffering
from thread-blocking in database calls.</p><p>This has several consequences however:</p><ul><li>reactive drivers to databases are bad at relations, which is why the
database is de-normalized in several ways, attempts to re-normalize the
schema will involve performance costs, and need for way more requests
to the database,</li><li>there is a clean border between the domain layer and the data access layer,
meaning that there is a need for mapping domain entities to
database entities.</li></ul><p>In the database access layer, the objects corresponding to domain entities are
<code>BatchEntity</code>, <code>ExecutionEntity</code>, <code>StepEntity</code> (which is actually part of a JSON
field in <code>ExecutionEntity</code>) and <code>OutputFileEntity</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="event-handlers">Event handlers<a href="#event-handlers" class="hash-link" aria-label="Direct link to Event handlers" title="Direct link to Event handlers">​</a></h4><p>This adapter uses AMQP event handlers reusing the REGARDS <code>IPublisher</code> and <code>IHandler</code>
interfaces. It is reusable as long as the mechanisms behind these interfaces
are available.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-management">Process management<a href="#process-management" class="hash-link" aria-label="Direct link to Process management" title="Direct link to Process management">​</a></h4><p>This adapter uses REGARDS plugins as described below. It is not reusable in a
different context.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workload-engine">Workload engine<a href="#workload-engine" class="hash-link" aria-label="Direct link to Workload engine" title="Direct link to Workload engine">​</a></h4><p>This adapter uses REGARDS jobs as described below. It is not reusable in a
different context.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="order-specific-design-choices"><code>Order</code> specific design choices<a href="#order-specific-design-choices" class="hash-link" aria-label="Direct link to order-specific-design-choices" title="Direct link to order-specific-design-choices">​</a></h3><p>The <code>Processing</code> service has a domain core based on a reactive stack and a
clean code architecture. This allows the service to be used in many contexts,
however its main use is in conjunction with the <code>Order</code> service, in the
REGARDS context, and reusing several REGARDS functionalities. This means that
<code>Processing</code> is not used in reactive mode, but in servlet mode, in this context.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="orderprocessinfo-scope-and-cardinality"><code>OrderProcessInfo</code>, scope and cardinality<a href="#orderprocessinfo-scope-and-cardinality" class="hash-link" aria-label="Direct link to orderprocessinfo-scope-and-cardinality" title="Direct link to orderprocessinfo-scope-and-cardinality">​</a></h4><p>A <code>PProcess</code> provides a metadata key/value store, which provides free information
to the user. The author of the process can put any useful information for using
the process in this metadata.</p><p>In the case of processes used by <code>Order</code>, this process info is interpreted as
an <code>OrderProcessInfo</code> object, containing:</p><ul><li>limitations on the quantity of data accepted as input,</li><li>the list of required <code>DataType</code> files (for instance, if a process will be applicable
only on <code>RAWDATA</code> files, this list contains only <code>RAWDATA</code>),</li><li>the process size forecast, so that Order can pre-calculate an estimate of
the size of the output files</li><li>and two informations we will discuss in more details below: scope and cardinality.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="process-scope">Process scope<a href="#process-scope" class="hash-link" aria-label="Direct link to Process scope" title="Direct link to Process scope">​</a></h5><p>The scope tells how to launch executions in the context of the same suborder.</p><p>The scope can be any of the two following values:</p><ul><li><code>FEATURE</code>: the process is designed to deal with one feature at a time, and thus
there will be one execution per feature in the suborder,</li><li><code>SUBORDER</code>: the process is designed to deal with several features at a time,
and there will be only one execution per suborder, with all the features given
as input.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="process-cardinality">Process cardinality<a href="#process-cardinality" class="hash-link" aria-label="Direct link to Process cardinality" title="Direct link to Process cardinality">​</a></h5><p>The cardinality tells how many output files an execution will generate.</p><p>The cardinality can be any of the following values:</p><ul><li><p><code>ONE_PER_INPUT_FILE</code>: the process is designed to produce one output file
for each input file.</p><p>An example of such a process would be a process which produces a companion
file for each input file, providing information about the file content,
its size, etc.</p></li><li><p><code>ONE_PER_FEATURE</code>: the process is designed to produce one output file
for each feature present in the suborder (this has the same result as
<code>ONE_PER_INPUT_FILE</code> if there is only one input file per feature, for
instance if the process requires only the <code>RAWDATA</code> files and each feature
has only one <code>RAWDATA</code>),</p><p>An example of such a process would be to create a compressed archive
for each feature, each archive containing all the files associated
to the feature.</p></li><li><p><code>ONE_PER_EXECUTION</code>: the process is designed to produce only one output
file, no matter what its input is.</p><p>An example of such a process would be to take several images
and generate a superposition of all these images, or again producing
a compressed archive of all the files present in the input.</p></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="scopecardinality-couples">Scope/cardinality couples<a href="#scopecardinality-couples" class="hash-link" aria-label="Direct link to Scope/cardinality couples" title="Direct link to Scope/cardinality couples">​</a></h5><p>Since there are 2 scopes and 3 cardinalities, there are 6 possible
combinations, but not all of them are meaningful/useful, and there is
redundancy.</p><p>For instance, the couples:</p><ul><li><code>scope=FEATURE cardinality=ONE_PER_FEATURE</code> and</li><li><code>scope=FEATURE cardinality=ONE_PER_EXECUTION</code> </li></ul><p>have the same result: the scope says that there is one execution per feature,
so they result in the same behaviour.</p><p>The other couples are:</p><ul><li><code>scope=FEATURE cardinality=ONE_PER_INPUT_FILE</code>, which may often also
have the same behaviour as the couple above, if there is only one file
provided as input for each feature (which may be the case if the process
requires only the <code>RAWDATA</code> files as input),</li><li><code>scope=SUBORDER cardinality=ONE_PER_FEATURE</code> is useful if the process
is designed to treat features independently but has better performances
when grouping several executions, for instance because it has a big
overhead in its initialization,</li><li><code>scope=SUBORDER cardinality=ONE_PER_INPUT_FILE</code> is useful in the same
cases, but now there are several files per feature and they are treated
independently, </li><li><code>scope=SUBORDER cardinality=ONE_PER_EXECUTION</code> is useful if the process
is designed to aggregate information from several features ; however there
is for now no possibility to group features according to criteria in the
same suborder, so the process must accept any group of features.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="general-algorithm-of-orderprocessing-interaction">General algorithm of Order/Processing interaction<a href="#general-algorithm-of-orderprocessing-interaction" class="hash-link" aria-label="Direct link to General algorithm of Order/Processing interaction" title="Direct link to General algorithm of Order/Processing interaction">​</a></h4><p>Here is a description of the way <code>Order</code> and <code>Processing</code> interact, leaving the
details of the <code>Processing</code> inner working out of the picture for more clarity.</p><p><img loading="lazy" alt="Order and Processing interaction" src="/assets/images/order_algo-9a097b89d03fb1a76195a4349796a307.png" width="1138" height="1666" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-definitions-are-regards-plugins">Process definitions are REGARDS Plugins<a href="#process-definitions-are-regards-plugins" class="hash-link" aria-label="Direct link to Process definitions are REGARDS Plugins" title="Direct link to Process definitions are REGARDS Plugins">​</a></h4><p>In the context of the <code>Processing</code> service deployed in REGARDS along with the
<code>Order</code> service, where processes are used to post-process entity feature files,
processes are defined as REGARDS plugins, implementing the <code>IProcessDefinition</code>
interface.</p><p>These plugins need some configuration:</p><ul><li>allowed dataset for a process</li><li>allowed user role to use a process</li></ul><p>This extra information is stored in database as a wrapper for
<code>PluginConfiguration</code> named <code>RightsPluginConfiguration</code>. There is a specific
REST API for interacting with these wrappers, which are used by the
administrator.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workload-engine-uses-regards-jobs">Workload engine uses REGARDS Jobs<a href="#workload-engine-uses-regards-jobs" class="hash-link" aria-label="Direct link to Workload engine uses REGARDS Jobs" title="Direct link to Workload engine uses REGARDS Jobs">​</a></h4><p>The provided workload engine uses the REGARDS jobs mechanism. When the workload
engine is given an executable, it creates a QUEUED job for execution as soon
as possible.</p><p>By setting the <code>regards.jobs.pool.size</code> property, we can limit the number
of jobs running in parallel, and thus the number of process executions. This limits
the overall number of jobs, however, and thus does not permit to limit the number
of executions <em>per process</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2><p>The <code>Processing</code> service can be specifically configured with the following properties:</p><ul><li><p><code>regards.processing.sharedStorage.basePath</code>:</p><p> Path to a shared storage for processes which need it to store output files.</p><p> A process may be programmed to create output files anywhere accessible by an URL,
but the <code>Processing</code> service provides as a convenience a shared storage accessible
to all REGARDS modules needing to access output files, as a mount point in the
file system. This way, output files can be passed as <code>file</code> protocol URLs.
</p></li><li><p><code>regards.processing.executionWorkdir.basePath</code>:</p><p> Path to a file system directory where a folder is created for each execution.</p><p> For processes which may use them, as a convenience, the <code>Processing</code> service
provides utilities to create execution work directories. These execution workdirs
are created as file system children of this parameter&#x27;s value.
</p></li><li><p><code>regards.processing.r2dbc.host</code>:</p><p> Host to connect to the database.
</p></li><li><p><code>regards.processing.r2dbc.port</code>:</p><p> Port to connect to the database.
</p></li><li><p><code>regards.processing.r2dbc.username</code>:</p><p> Username to connect to the database.
</p></li><li><p><code>regards.processing.r2dbc.password</code>:</p><p> Password to connect to the database.
</p></li><li><p><code>regards.processing.r2dbc.dbname</code>:</p><p> Name of the database to connect to.
</p></li><li><p><code>regards.processing.r2dbc.schema</code>:</p><p> Schema of the database to connect to.
</p></li><li><p><code>regards.processing.outputfiles.cleanup.cron</code>:</p><p> Cron expression to look for downloaded output files and delete them.</p><p> Output files saved in the storage are cleaned up regularly.
This cron expression defines how often.
</p></li><li><p><code>regards.processing.executions.timedout.cleanup.cron</code>:</p><p> Cron expression to look for timed out executions.</p><p> When an execution is created, we use the duration forecast
of its parent process to determine an expected runtime duration.
This time is multiplied by two and saved in base.
At every trigger of this cron expression, we look for executions
that are still running after this saved duration, and declare
them as timed out. This puts them in a final state and notifies
the user of the time out. Users may choose to retry.
</p></li><li><p><code>regards.processing.cleanup.batch.age.ms</code>:</p><p> Minimum for old terminated batches selected for suppression.</p><p> Old batches, for which all executions are in a final state, are
regularly cleaned up. This property say how much time after the last
execution&#x27;s last update a batch is considered too old and
is selected for deletion.</p></li><li><p><code>regards.processing.cleanup.batch.rate.ms</code>:</p><p> How often we look for old batches to delete them.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="available-apis">Available APIs<a href="#available-apis" class="hash-link" aria-label="Direct link to Available APIs" title="Direct link to Available APIs">​</a></h2><ul><li><a href="/docs/1.12.0/development/backend/services/processing/api/process">Process</a> : API to list/find existing processes</li><li><a href="/docs/1.12.0/development/backend/services/processing/api/batch">Batch</a> : API to create batches</li><li><a href="/docs/1.12.0/development/backend/services/processing/api/monitoring">Monitoring</a> : API to monitor existing executions</li><li><a href="/docs/1.12.0/development/backend/services/processing/plugins">Rights Plugin Configurations</a> : API to manage processes as plugins</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/RegardsOss/RegardsOss.github.io/edit/master/versioned_docs/version-1.12.0/development/backend/regards/processing/processing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/1.12.0/development/backend/services/order/api-swagger"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">REST API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/1.12.0/development/backend/services/processing/api-swagger"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#processing-architecture" class="table-of-contents__link toc-highlight">Processing architecture</a><ul><li><a href="#domain-entities" class="table-of-contents__link toc-highlight">Domain entities</a></li><li><a href="#pbatch" class="table-of-contents__link toc-highlight"><code>PBatch</code></a></li><li><a href="#pexecution" class="table-of-contents__link toc-highlight"><code>PExecution</code></a></li><li><a href="#pinputfile" class="table-of-contents__link toc-highlight"><code>PInputFile</code></a></li><li><a href="#pstep" class="table-of-contents__link toc-highlight"><code>PStep</code></a></li><li><a href="#poutputfile" class="table-of-contents__link toc-highlight"><code>POutputFile</code></a></li></ul></li><li><a href="#general-algorithm" class="table-of-contents__link toc-highlight">General algorithm</a></li><li><a href="#technical-details" class="table-of-contents__link toc-highlight">Technical details</a><ul><li><a href="#workload-engine--executable--execution-context" class="table-of-contents__link toc-highlight">Workload engine / executable / execution context</a></li><li><a href="#reactive-first-service" class="table-of-contents__link toc-highlight">Reactive-first service</a></li><li><a href="#clean-architecture" class="table-of-contents__link toc-highlight">Clean architecture</a></li><li><a href="#order-specific-design-choices" class="table-of-contents__link toc-highlight"><code>Order</code> specific design choices</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#available-apis" class="table-of-contents__link toc-highlight">Available APIs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container_grid_bQnQ"><div class="col_1_KTIr"><p><strong>A framework and a set of plugins to build scientific archives.</strong></p><p>REGARDS is an Open Source data valorization product, highly flexible to various themes, modular, efficient, long-lasting, evolutionary and scalable, aims at providing services to Mission Centers and laboratories, and is able to deal with huge amount of data. <br>Our goal is to allow a strong commitment from user community in the development of modules and plugins.</p><p><strong>We welcome <a href="https://github.com/RegardsOss/RegardsOss.github.io/blob/master/CONTRIBUTING.md">your contributions</a> to make these documents better.</strong></p><div><img src="/img/logos/courbe-institutionnelle-signature_y110-inverser.png"></div></div><div class="col_2_Jonb"><h4 class="footer__title">Users</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/user-guide">Manual</a></li></ul></div><div class="col_2_Jonb"><h4 class="footer__title">Developpers</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/setup">Install</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/development/backend/architecture/concepts">Backend</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/docs/development/frontend/introduction/setup">Frontend</a></li></ul></div><div class="col_2_Jonb"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/RegardsOss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 REGARDS, OSS. Built with Docusaurus.</div></div></footer></div>
<script src="/assets/js/runtime~main.06899180.js"></script>
<script src="/assets/js/main.624bd5d5.js"></script>
</body>
</html>