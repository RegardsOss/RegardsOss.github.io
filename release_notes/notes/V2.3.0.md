---
id: release-notes-v2.3.0
title: Version 2.3.0
slug: /v2.3.0/
sidebar_position: 9972
---

Released on : xx/xx/2025  
[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
**Operational version**

## Features

### Indexation improvement

Elastic entities insertions are now asynchronous. It is now recommended to increase the size of the Elasticsearch connection pool to handle the higher level of parallelism. See the [configuration guide](../docs/next/development/services/dam/configuration/static-configuration#ansible-editable-properties) for details on how to configure this value (regards.jpa.multitenant.maxPoolSize).

### Restriction to one category per OAIS product

The ability to associate several categories per OAIS product has never been used, so the data structure and APIs
have been modified to permit only one category per product. This restriction allows some performance improvements
during crawling on OAIS products, and in the administration interface.

### Improved Naming and Layout of Delivery Files

The name and structure of the zip files generated by the delivery service have evolved. The new naming conventions
are described [in the documentation](../docs/next/user-guide/order-data/settings-delivery#format-de-livraison).

## Breaking changes

### Deployment

You need to follow the [Ansible migration guide](../../docs/next/setup/swarm/migration/2.2-to-2.3) to update your 
playbook from V2.2.0 to V2.3.0.

### Database

#### OAIS Category change

The database tables `ingest.t_sip` and `ingest.t_aip` have changed: the `categories` column (format jsonb) is replaced 
by a `category` column (format varchar 128). After first deploying the 2.3.0 version of the service, the data 
will be moved to the new column. If the `categories` column contained a list of a single category, it will be 
transferred to the new column. If it contained several categories, only the first one will be preserved.

The change is automatic on updating the service, but may take a long time depending on the number of products. 
If the script takes too long, the service may restart before the migration finishes. In this case the migration 
will continue from where it was when the service restarts. It may happen several times, until it eventually 
completes the migration.
To avoid any problem during the migration, we provide a script to manually modify these 2 tables, to be executed 
after shutdown of the current system and before the restart in the new version: see the 
[Ansible migration guide](../../docs/next/setup/swarm/migration/2.2-to-2.3).

Similarly for the acquisition chains in service `dataprovider`: the table `dataprovider.t_acq_processing_chain` 
has had its `categories` column replaced by a `category` column. The change is automatic on updating the service 
and the data is migrated automatically. If the `categories` column contained a list of a single category, 
it will be transferred to the new column. If it contained several categories, only the first one will be preserved.

#### Index changes

An index was added in the table `ingest.t_aip` on (`last_update`, `id`) to improve the performance 
of aspirations of OAIS products.
An index was replaced in the table `fem.t_feature` on (`model`, `last_update`) by a new one on (`model`, `last_update`, `id`)
to improve the performance of aspirations of GeoJson products.
These changes are automatic on updating the service, but may take a long time depending on the number of products.
To avoid any problem during the migration, the script provided for the OAIS Category change above can be used, 
it also performs the update to the indexes.
To be executed after shutdown of the current system and before the restart in the new version: 
See the [Ansible migration guide](../../docs/next/setup/swarm/migration/2.2-to-2.3).

### Rest API

The OAIS product manager modification API (rs-ingest/aips/update) no longer allows to set multiple categories on a product.
Requests to add a category to a product that already has one, or to add multiple categories will be ignored.
It is still possible to replace an existing category by removing it and adding another one at the same time.

### Service configuration

The format for the configuration file for the `rs-dataprovider` service has changed following the change 
to a single category.
When specifying an AcquisitionProcessingChain in the configuration, the `categories` attribute must be replaced 
by a `category` attribute containing a single string.

### AMQP API

OAIS products for rs-ingest no longer allow multiple categories. To allow retro-compatibility, a product can have either 
a string `category` field, or a list `categories` field with a single category, but not both. 
The use of the `categories` field is deprecated.

The OAISMigrationWorker no longer allows multiple categories in a product. To allow retro-compatibility, 
a product can have either a string `category` field, or a list `categories` field with a single category, 
but not both. The use of the `categories` field is deprecated.

## Bug fixes
